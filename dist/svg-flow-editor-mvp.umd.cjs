(function(J,Q){typeof exports=="object"&&typeof module<"u"?Q(exports):typeof define=="function"&&define.amd?define(["exports"],Q):(J=typeof globalThis<"u"?globalThis:J||self,Q(J["svg-flow-editor-mvp"]={}))})(this,function(J){"use strict";var _o=Object.defineProperty;var po=(J,Q,at)=>Q in J?_o(J,Q,{enumerable:!0,configurable:!0,writable:!0,value:at}):J[Q]=at;var f=(J,Q,at)=>(po(J,typeof Q!="symbol"?Q+"":Q,at),at);class Q{constructor(n){f(this,"draw");this.draw=n}background(){console.log(this.draw)}pageScaleRecovery(){this.draw.getEditorEvent().scalePage("Recovery")}pageScaleMinus(){this.draw.getEditorEvent().scalePage("Minus")}pageScaleAdd(){this.draw.getEditorEvent().scalePage("Add")}setPageScale(n){if(!n||typeof n!="number")return;this.draw.getEditorEvent().scalePage("Appoint",n)}fullScreen(){const n=this.draw.getRoot();n.requestFullscreen&&n.requestFullscreen();const e=setTimeout(()=>{this.draw.getCanvasDraw().resetCanvas(),clearTimeout(e)},100)}exitFullScreen(){try{document.exitFullscreen();const n=setTimeout(()=>{this.draw.getCanvasDraw().resetCanvas(),clearTimeout(n)},100)}catch{}}paste(){}copy(){}cut(){}undo(){}redo(){}top(){const n=this.draw.getGraphEvent().getSelected();if(!n)return;const e=this.draw.getGraphEvent().getAllGraphMain();var i=[];e.forEach(s=>i.push(~~s.style.zIndex));const a=Math.max.apply(Math,i),r=~~n.style.zIndex;r<=a&&(n.style.zIndex=r===1?r.toString():(r+2).toString())}bottom(){const n=this.draw.getGraphEvent().getSelected();if(!n)return;const e=this.draw.getGraphEvent().getAllGraphMain();var i=[];e.forEach(s=>i.push(~~s.style.zIndex));const a=Math.min.apply(Math,i),r=~~n.style.zIndex;r>=a&&(n.style.zIndex=r===1?r.toString():(r-2).toString())}holdup(){const n=this.draw.getGraphEvent().getSelected();if(!n)return;const e=~~n.style.zIndex;n.style.zIndex=(e+1).toString()}putdown(){const n=this.draw.getGraphEvent().getSelected();if(!n)return;const e=~~n.style.zIndex;n.style.zIndex=e===1?e.toString():(e-1).toString()}group(){}ungroup(){}}class at{constructor(n){f(this,"executeBackground");f(this,"executeFullScreen");f(this,"executeExitFullScreen");f(this,"executePageScaleRecovery");f(this,"executePageScaleMinus");f(this,"executePageScaleAdd");f(this,"setPageScale");f(this,"executePaste");f(this,"executeCopy");f(this,"executeCut");f(this,"executeUndo");f(this,"executeRedo");f(this,"executeTop");f(this,"executeBottom");f(this,"executeHoldUp");f(this,"executePutDown");f(this,"executeGroup");f(this,"executeUnGroup");const e=new Q(n);this.executeBackground=e.background.bind(e),this.executePageScaleRecovery=e.pageScaleRecovery.bind(e),this.executePageScaleMinus=e.pageScaleMinus.bind(e),this.executePageScaleAdd=e.pageScaleAdd.bind(e),this.setPageScale=e.setPageScale.bind(e),this.executeFullScreen=e.fullScreen.bind(e),this.executeExitFullScreen=e.exitFullScreen.bind(e),this.executePaste=e.paste.bind(e),this.executeCopy=e.copy.bind(e),this.executeCut=e.cut.bind(e),this.executeUndo=e.undo.bind(e),this.executeRedo=e.redo.bind(e),this.executeTop=e.top.bind(e),this.executeBottom=e.bottom.bind(e),this.executeHoldUp=e.holdup.bind(e),this.executePutDown=e.putdown.bind(e),this.executeGroup=e.group.bind(e),this.executeUnGroup=e.ungroup.bind(e)}}const an={selectorEmpty:"The provided selector is empty.",selectorError:"The selector is not Available.Maybe you need to wait for Dom rendering to completed."},Mi="sfEditor",Bi="http://www.w3.org/2000/svg",$i={colorful_theme1:{background:"#fff",stroke:"#000",fill:"#fff",text:"#000",line:"#000",auxiliaryLine:"#000"},colorful_theme2:{background:"#fff",stroke:"#067bef",fill:"#212930",text:"#fff",line:"#000",auxiliaryLine:"#000"},colorful_theme3:{background:"#fff",stroke:"#067bef",fill:"#FFFFEE",text:"#000",line:"#000",auxiliaryLine:"#000"},colorful_theme4:{background:"#fff",stroke:"#067bef",fill:"#D6D6D6",text:"#000",line:"#000",auxiliaryLine:"#000"},colorful_theme5:{background:"#363332",stroke:"#067bef",fill:"#F4B49D",text:"#7f2f24",line:"#8F493F",auxiliaryLine:"#000"}};function rt(t){(window.requestIdleCallback||window.setTimeout)(()=>{t()})}const Pi=typeof navigator<"u"&&/Mac OS X/.test(navigator.userAgent);function Oi(t){return Pi?t.metaKey:t.ctrlKey}function Fi(t,n){const e=document.querySelector("head"),i=e.querySelector("#colorful_theme");i&&i.remove();var a="";const r=Object.assign($i[t],n);for(const o in r)if(Object.prototype.hasOwnProperty.call(r,o)){const d=r[o];a+=`--${o}:${d};`}const s=document.createElement("style");s.setAttribute("id","colorful_theme"),s.innerHTML=`:root{${a}}`,e.appendChild(s)}var Ni=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ui(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Zi={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const Ot=Zi,rn={};for(const t of Object.keys(Ot))rn[Ot[t]]=t;const y={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var sn=y;for(const t of Object.keys(y)){if(!("channels"in y[t]))throw new Error("missing channels property: "+t);if(!("labels"in y[t]))throw new Error("missing channel labels property: "+t);if(y[t].labels.length!==y[t].channels)throw new Error("channel and label counts mismatch: "+t);const{channels:n,labels:e}=y[t];delete y[t].channels,delete y[t].labels,Object.defineProperty(y[t],"channels",{value:n}),Object.defineProperty(y[t],"labels",{value:e})}y.rgb.hsl=function(t){const n=t[0]/255,e=t[1]/255,i=t[2]/255,a=Math.min(n,e,i),r=Math.max(n,e,i),s=r-a;let o,d;r===a?o=0:n===r?o=(e-i)/s:e===r?o=2+(i-n)/s:i===r&&(o=4+(n-e)/s),o=Math.min(o*60,360),o<0&&(o+=360);const l=(a+r)/2;return r===a?d=0:l<=.5?d=s/(r+a):d=s/(2-r-a),[o,d*100,l*100]},y.rgb.hsv=function(t){let n,e,i,a,r;const s=t[0]/255,o=t[1]/255,d=t[2]/255,l=Math.max(s,o,d),c=l-Math.min(s,o,d),u=function(g){return(l-g)/6/c+1/2};return c===0?(a=0,r=0):(r=c/l,n=u(s),e=u(o),i=u(d),s===l?a=i-e:o===l?a=1/3+n-i:d===l&&(a=2/3+e-n),a<0?a+=1:a>1&&(a-=1)),[a*360,r*100,l*100]},y.rgb.hwb=function(t){const n=t[0],e=t[1];let i=t[2];const a=y.rgb.hsl(t)[0],r=1/255*Math.min(n,Math.min(e,i));return i=1-1/255*Math.max(n,Math.max(e,i)),[a,r*100,i*100]},y.rgb.cmyk=function(t){const n=t[0]/255,e=t[1]/255,i=t[2]/255,a=Math.min(1-n,1-e,1-i),r=(1-n-a)/(1-a)||0,s=(1-e-a)/(1-a)||0,o=(1-i-a)/(1-a)||0;return[r*100,s*100,o*100,a*100]};function Gi(t,n){return(t[0]-n[0])**2+(t[1]-n[1])**2+(t[2]-n[2])**2}y.rgb.keyword=function(t){const n=rn[t];if(n)return n;let e=1/0,i;for(const a of Object.keys(Ot)){const r=Ot[a],s=Gi(t,r);s<e&&(e=s,i=a)}return i},y.keyword.rgb=function(t){return Ot[t]},y.rgb.xyz=function(t){let n=t[0]/255,e=t[1]/255,i=t[2]/255;n=n>.04045?((n+.055)/1.055)**2.4:n/12.92,e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,i=i>.04045?((i+.055)/1.055)**2.4:i/12.92;const a=n*.4124+e*.3576+i*.1805,r=n*.2126+e*.7152+i*.0722,s=n*.0193+e*.1192+i*.9505;return[a*100,r*100,s*100]},y.rgb.lab=function(t){const n=y.rgb.xyz(t);let e=n[0],i=n[1],a=n[2];e/=95.047,i/=100,a/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,i=i>.008856?i**(1/3):7.787*i+16/116,a=a>.008856?a**(1/3):7.787*a+16/116;const r=116*i-16,s=500*(e-i),o=200*(i-a);return[r,s,o]},y.hsl.rgb=function(t){const n=t[0]/360,e=t[1]/100,i=t[2]/100;let a,r,s;if(e===0)return s=i*255,[s,s,s];i<.5?a=i*(1+e):a=i+e-i*e;const o=2*i-a,d=[0,0,0];for(let l=0;l<3;l++)r=n+1/3*-(l-1),r<0&&r++,r>1&&r--,6*r<1?s=o+(a-o)*6*r:2*r<1?s=a:3*r<2?s=o+(a-o)*(2/3-r)*6:s=o,d[l]=s*255;return d},y.hsl.hsv=function(t){const n=t[0];let e=t[1]/100,i=t[2]/100,a=e;const r=Math.max(i,.01);i*=2,e*=i<=1?i:2-i,a*=r<=1?r:2-r;const s=(i+e)/2,o=i===0?2*a/(r+a):2*e/(i+e);return[n,o*100,s*100]},y.hsv.rgb=function(t){const n=t[0]/60,e=t[1]/100;let i=t[2]/100;const a=Math.floor(n)%6,r=n-Math.floor(n),s=255*i*(1-e),o=255*i*(1-e*r),d=255*i*(1-e*(1-r));switch(i*=255,a){case 0:return[i,d,s];case 1:return[o,i,s];case 2:return[s,i,d];case 3:return[s,o,i];case 4:return[d,s,i];case 5:return[i,s,o]}},y.hsv.hsl=function(t){const n=t[0],e=t[1]/100,i=t[2]/100,a=Math.max(i,.01);let r,s;s=(2-e)*i;const o=(2-e)*a;return r=e*a,r/=o<=1?o:2-o,r=r||0,s/=2,[n,r*100,s*100]},y.hwb.rgb=function(t){const n=t[0]/360;let e=t[1]/100,i=t[2]/100;const a=e+i;let r;a>1&&(e/=a,i/=a);const s=Math.floor(6*n),o=1-i;r=6*n-s,s&1&&(r=1-r);const d=e+r*(o-e);let l,c,u;switch(s){default:case 6:case 0:l=o,c=d,u=e;break;case 1:l=d,c=o,u=e;break;case 2:l=e,c=o,u=d;break;case 3:l=e,c=d,u=o;break;case 4:l=d,c=e,u=o;break;case 5:l=o,c=e,u=d;break}return[l*255,c*255,u*255]},y.cmyk.rgb=function(t){const n=t[0]/100,e=t[1]/100,i=t[2]/100,a=t[3]/100,r=1-Math.min(1,n*(1-a)+a),s=1-Math.min(1,e*(1-a)+a),o=1-Math.min(1,i*(1-a)+a);return[r*255,s*255,o*255]},y.xyz.rgb=function(t){const n=t[0]/100,e=t[1]/100,i=t[2]/100;let a,r,s;return a=n*3.2406+e*-1.5372+i*-.4986,r=n*-.9689+e*1.8758+i*.0415,s=n*.0557+e*-.204+i*1.057,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,r=r>.0031308?1.055*r**(1/2.4)-.055:r*12.92,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,a=Math.min(Math.max(0,a),1),r=Math.min(Math.max(0,r),1),s=Math.min(Math.max(0,s),1),[a*255,r*255,s*255]},y.xyz.lab=function(t){let n=t[0],e=t[1],i=t[2];n/=95.047,e/=100,i/=108.883,n=n>.008856?n**(1/3):7.787*n+16/116,e=e>.008856?e**(1/3):7.787*e+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;const a=116*e-16,r=500*(n-e),s=200*(e-i);return[a,r,s]},y.lab.xyz=function(t){const n=t[0],e=t[1],i=t[2];let a,r,s;r=(n+16)/116,a=e/500+r,s=r-i/200;const o=r**3,d=a**3,l=s**3;return r=o>.008856?o:(r-16/116)/7.787,a=d>.008856?d:(a-16/116)/7.787,s=l>.008856?l:(s-16/116)/7.787,a*=95.047,r*=100,s*=108.883,[a,r,s]},y.lab.lch=function(t){const n=t[0],e=t[1],i=t[2];let a;a=Math.atan2(i,e)*360/2/Math.PI,a<0&&(a+=360);const s=Math.sqrt(e*e+i*i);return[n,s,a]},y.lch.lab=function(t){const n=t[0],e=t[1],a=t[2]/360*2*Math.PI,r=e*Math.cos(a),s=e*Math.sin(a);return[n,r,s]},y.rgb.ansi16=function(t,n=null){const[e,i,a]=t;let r=n===null?y.rgb.hsv(t)[2]:n;if(r=Math.round(r/50),r===0)return 30;let s=30+(Math.round(a/255)<<2|Math.round(i/255)<<1|Math.round(e/255));return r===2&&(s+=60),s},y.hsv.ansi16=function(t){return y.rgb.ansi16(y.hsv.rgb(t),t[2])},y.rgb.ansi256=function(t){const n=t[0],e=t[1],i=t[2];return n===e&&e===i?n<8?16:n>248?231:Math.round((n-8)/247*24)+232:16+36*Math.round(n/255*5)+6*Math.round(e/255*5)+Math.round(i/255*5)},y.ansi16.rgb=function(t){let n=t%10;if(n===0||n===7)return t>50&&(n+=3.5),n=n/10.5*255,[n,n,n];const e=(~~(t>50)+1)*.5,i=(n&1)*e*255,a=(n>>1&1)*e*255,r=(n>>2&1)*e*255;return[i,a,r]},y.ansi256.rgb=function(t){if(t>=232){const r=(t-232)*10+8;return[r,r,r]}t-=16;let n;const e=Math.floor(t/36)/5*255,i=Math.floor((n=t%36)/6)/5*255,a=n%6/5*255;return[e,i,a]},y.rgb.hex=function(t){const e=(((Math.round(t[0])&255)<<16)+((Math.round(t[1])&255)<<8)+(Math.round(t[2])&255)).toString(16).toUpperCase();return"000000".substring(e.length)+e},y.hex.rgb=function(t){const n=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!n)return[0,0,0];let e=n[0];n[0].length===3&&(e=e.split("").map(o=>o+o).join(""));const i=parseInt(e,16),a=i>>16&255,r=i>>8&255,s=i&255;return[a,r,s]},y.rgb.hcg=function(t){const n=t[0]/255,e=t[1]/255,i=t[2]/255,a=Math.max(Math.max(n,e),i),r=Math.min(Math.min(n,e),i),s=a-r;let o,d;return s<1?o=r/(1-s):o=0,s<=0?d=0:a===n?d=(e-i)/s%6:a===e?d=2+(i-n)/s:d=4+(n-e)/s,d/=6,d%=1,[d*360,s*100,o*100]},y.hsl.hcg=function(t){const n=t[1]/100,e=t[2]/100,i=e<.5?2*n*e:2*n*(1-e);let a=0;return i<1&&(a=(e-.5*i)/(1-i)),[t[0],i*100,a*100]},y.hsv.hcg=function(t){const n=t[1]/100,e=t[2]/100,i=n*e;let a=0;return i<1&&(a=(e-i)/(1-i)),[t[0],i*100,a*100]},y.hcg.rgb=function(t){const n=t[0]/360,e=t[1]/100,i=t[2]/100;if(e===0)return[i*255,i*255,i*255];const a=[0,0,0],r=n%1*6,s=r%1,o=1-s;let d=0;switch(Math.floor(r)){case 0:a[0]=1,a[1]=s,a[2]=0;break;case 1:a[0]=o,a[1]=1,a[2]=0;break;case 2:a[0]=0,a[1]=1,a[2]=s;break;case 3:a[0]=0,a[1]=o,a[2]=1;break;case 4:a[0]=s,a[1]=0,a[2]=1;break;default:a[0]=1,a[1]=0,a[2]=o}return d=(1-e)*i,[(e*a[0]+d)*255,(e*a[1]+d)*255,(e*a[2]+d)*255]},y.hcg.hsv=function(t){const n=t[1]/100,e=t[2]/100,i=n+e*(1-n);let a=0;return i>0&&(a=n/i),[t[0],a*100,i*100]},y.hcg.hsl=function(t){const n=t[1]/100,i=t[2]/100*(1-n)+.5*n;let a=0;return i>0&&i<.5?a=n/(2*i):i>=.5&&i<1&&(a=n/(2*(1-i))),[t[0],a*100,i*100]},y.hcg.hwb=function(t){const n=t[1]/100,e=t[2]/100,i=n+e*(1-n);return[t[0],(i-n)*100,(1-i)*100]},y.hwb.hcg=function(t){const n=t[1]/100,i=1-t[2]/100,a=i-n;let r=0;return a<1&&(r=(i-a)/(1-a)),[t[0],a*100,r*100]},y.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},y.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},y.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},y.gray.hsl=function(t){return[0,0,t[0]]},y.gray.hsv=y.gray.hsl,y.gray.hwb=function(t){return[0,100,t[0]]},y.gray.cmyk=function(t){return[0,0,0,t[0]]},y.gray.lab=function(t){return[t[0],0,0]},y.gray.hex=function(t){const n=Math.round(t[0]/100*255)&255,i=((n<<16)+(n<<8)+n).toString(16).toUpperCase();return"000000".substring(i.length)+i},y.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]};const oe=sn;function qi(){const t={},n=Object.keys(oe);for(let e=n.length,i=0;i<e;i++)t[n[i]]={distance:-1,parent:null};return t}function Yi(t){const n=qi(),e=[t];for(n[t].distance=0;e.length;){const i=e.pop(),a=Object.keys(oe[i]);for(let r=a.length,s=0;s<r;s++){const o=a[s],d=n[o];d.distance===-1&&(d.distance=n[i].distance+1,d.parent=i,e.unshift(o))}}return n}function ji(t,n){return function(e){return n(t(e))}}function Xi(t,n){const e=[n[t].parent,t];let i=oe[n[t].parent][t],a=n[t].parent;for(;n[a].parent;)e.unshift(n[a].parent),i=ji(oe[n[a].parent][a],i),a=n[a].parent;return i.conversion=e,i}var Wi=function(t){const n=Yi(t),e={},i=Object.keys(n);for(let a=i.length,r=0;r<a;r++){const s=i[r];n[s].parent!==null&&(e[s]=Xi(s,n))}return e};const xe=sn,Vi=Wi,Tt={},Ji=Object.keys(xe);function Qi(t){const n=function(...e){const i=e[0];return i==null?i:(i.length>1&&(e=i),t(e))};return"conversion"in t&&(n.conversion=t.conversion),n}function Ki(t){const n=function(...e){const i=e[0];if(i==null)return i;i.length>1&&(e=i);const a=t(e);if(typeof a=="object")for(let r=a.length,s=0;s<r;s++)a[s]=Math.round(a[s]);return a};return"conversion"in t&&(n.conversion=t.conversion),n}Ji.forEach(t=>{Tt[t]={},Object.defineProperty(Tt[t],"channels",{value:xe[t].channels}),Object.defineProperty(Tt[t],"labels",{value:xe[t].labels});const n=Vi(t);Object.keys(n).forEach(i=>{const a=n[i];Tt[t][i]=Ki(a),Tt[t][i].raw=Qi(a)})});var on=Tt;/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const ta=4,ln=0,cn=1,ea=2;function Ct(t){let n=t.length;for(;--n>=0;)t[n]=0}const na=0,dn=1,ia=2,aa=3,ra=258,Ee=29,Ft=256,Nt=Ft+1+Ee,zt=30,ye=19,hn=2*Nt+1,wt=15,ke=16,sa=7,Se=256,fn=16,un=17,gn=18,Ae=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),le=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),oa=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),_n=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),la=512,dt=new Array((Nt+2)*2);Ct(dt);const Ut=new Array(zt*2);Ct(Ut);const Zt=new Array(la);Ct(Zt);const Gt=new Array(ra-aa+1);Ct(Gt);const De=new Array(Ee);Ct(De);const ce=new Array(zt);Ct(ce);function Le(t,n,e,i,a){this.static_tree=t,this.extra_bits=n,this.extra_base=e,this.elems=i,this.max_length=a,this.has_stree=t&&t.length}let pn,mn,bn;function Te(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}const wn=t=>t<256?Zt[t]:Zt[256+(t>>>7)],qt=(t,n)=>{t.pending_buf[t.pending++]=n&255,t.pending_buf[t.pending++]=n>>>8&255},X=(t,n,e)=>{t.bi_valid>ke-e?(t.bi_buf|=n<<t.bi_valid&65535,qt(t,t.bi_buf),t.bi_buf=n>>ke-t.bi_valid,t.bi_valid+=e-ke):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=e)},st=(t,n,e)=>{X(t,e[n*2],e[n*2+1])},vn=(t,n)=>{let e=0;do e|=t&1,t>>>=1,e<<=1;while(--n>0);return e>>>1},ca=t=>{t.bi_valid===16?(qt(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},da=(t,n)=>{const e=n.dyn_tree,i=n.max_code,a=n.stat_desc.static_tree,r=n.stat_desc.has_stree,s=n.stat_desc.extra_bits,o=n.stat_desc.extra_base,d=n.stat_desc.max_length;let l,c,u,g,h,p,k=0;for(g=0;g<=wt;g++)t.bl_count[g]=0;for(e[t.heap[t.heap_max]*2+1]=0,l=t.heap_max+1;l<hn;l++)c=t.heap[l],g=e[e[c*2+1]*2+1]+1,g>d&&(g=d,k++),e[c*2+1]=g,!(c>i)&&(t.bl_count[g]++,h=0,c>=o&&(h=s[c-o]),p=e[c*2],t.opt_len+=p*(g+h),r&&(t.static_len+=p*(a[c*2+1]+h)));if(k!==0){do{for(g=d-1;t.bl_count[g]===0;)g--;t.bl_count[g]--,t.bl_count[g+1]+=2,t.bl_count[d]--,k-=2}while(k>0);for(g=d;g!==0;g--)for(c=t.bl_count[g];c!==0;)u=t.heap[--l],!(u>i)&&(e[u*2+1]!==g&&(t.opt_len+=(g-e[u*2+1])*e[u*2],e[u*2+1]=g),c--)}},xn=(t,n,e)=>{const i=new Array(wt+1);let a=0,r,s;for(r=1;r<=wt;r++)a=a+e[r-1]<<1,i[r]=a;for(s=0;s<=n;s++){let o=t[s*2+1];o!==0&&(t[s*2]=vn(i[o]++,o))}},ha=()=>{let t,n,e,i,a;const r=new Array(wt+1);for(e=0,i=0;i<Ee-1;i++)for(De[i]=e,t=0;t<1<<Ae[i];t++)Gt[e++]=i;for(Gt[e-1]=i,a=0,i=0;i<16;i++)for(ce[i]=a,t=0;t<1<<le[i];t++)Zt[a++]=i;for(a>>=7;i<zt;i++)for(ce[i]=a<<7,t=0;t<1<<le[i]-7;t++)Zt[256+a++]=i;for(n=0;n<=wt;n++)r[n]=0;for(t=0;t<=143;)dt[t*2+1]=8,t++,r[8]++;for(;t<=255;)dt[t*2+1]=9,t++,r[9]++;for(;t<=279;)dt[t*2+1]=7,t++,r[7]++;for(;t<=287;)dt[t*2+1]=8,t++,r[8]++;for(xn(dt,Nt+1,r),t=0;t<zt;t++)Ut[t*2+1]=5,Ut[t*2]=vn(t,5);pn=new Le(dt,Ae,Ft+1,Nt,wt),mn=new Le(Ut,le,0,zt,wt),bn=new Le(new Array(0),oa,0,ye,sa)},En=t=>{let n;for(n=0;n<Nt;n++)t.dyn_ltree[n*2]=0;for(n=0;n<zt;n++)t.dyn_dtree[n*2]=0;for(n=0;n<ye;n++)t.bl_tree[n*2]=0;t.dyn_ltree[Se*2]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},yn=t=>{t.bi_valid>8?qt(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},kn=(t,n,e,i)=>{const a=n*2,r=e*2;return t[a]<t[r]||t[a]===t[r]&&i[n]<=i[e]},Ce=(t,n,e)=>{const i=t.heap[e];let a=e<<1;for(;a<=t.heap_len&&(a<t.heap_len&&kn(n,t.heap[a+1],t.heap[a],t.depth)&&a++,!kn(n,i,t.heap[a],t.depth));)t.heap[e]=t.heap[a],e=a,a<<=1;t.heap[e]=i},Sn=(t,n,e)=>{let i,a,r=0,s,o;if(t.sym_next!==0)do i=t.pending_buf[t.sym_buf+r++]&255,i+=(t.pending_buf[t.sym_buf+r++]&255)<<8,a=t.pending_buf[t.sym_buf+r++],i===0?st(t,a,n):(s=Gt[a],st(t,s+Ft+1,n),o=Ae[s],o!==0&&(a-=De[s],X(t,a,o)),i--,s=wn(i),st(t,s,e),o=le[s],o!==0&&(i-=ce[s],X(t,i,o)));while(r<t.sym_next);st(t,Se,n)},ze=(t,n)=>{const e=n.dyn_tree,i=n.stat_desc.static_tree,a=n.stat_desc.has_stree,r=n.stat_desc.elems;let s,o,d=-1,l;for(t.heap_len=0,t.heap_max=hn,s=0;s<r;s++)e[s*2]!==0?(t.heap[++t.heap_len]=d=s,t.depth[s]=0):e[s*2+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=d<2?++d:0,e[l*2]=1,t.depth[l]=0,t.opt_len--,a&&(t.static_len-=i[l*2+1]);for(n.max_code=d,s=t.heap_len>>1;s>=1;s--)Ce(t,e,s);l=r;do s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Ce(t,e,1),o=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=o,e[l*2]=e[s*2]+e[o*2],t.depth[l]=(t.depth[s]>=t.depth[o]?t.depth[s]:t.depth[o])+1,e[s*2+1]=e[o*2+1]=l,t.heap[1]=l++,Ce(t,e,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],da(t,n),xn(e,d,t.bl_count)},An=(t,n,e)=>{let i,a=-1,r,s=n[0*2+1],o=0,d=7,l=4;for(s===0&&(d=138,l=3),n[(e+1)*2+1]=65535,i=0;i<=e;i++)r=s,s=n[(i+1)*2+1],!(++o<d&&r===s)&&(o<l?t.bl_tree[r*2]+=o:r!==0?(r!==a&&t.bl_tree[r*2]++,t.bl_tree[fn*2]++):o<=10?t.bl_tree[un*2]++:t.bl_tree[gn*2]++,o=0,a=r,s===0?(d=138,l=3):r===s?(d=6,l=3):(d=7,l=4))},Dn=(t,n,e)=>{let i,a=-1,r,s=n[0*2+1],o=0,d=7,l=4;for(s===0&&(d=138,l=3),i=0;i<=e;i++)if(r=s,s=n[(i+1)*2+1],!(++o<d&&r===s)){if(o<l)do st(t,r,t.bl_tree);while(--o!==0);else r!==0?(r!==a&&(st(t,r,t.bl_tree),o--),st(t,fn,t.bl_tree),X(t,o-3,2)):o<=10?(st(t,un,t.bl_tree),X(t,o-3,3)):(st(t,gn,t.bl_tree),X(t,o-11,7));o=0,a=r,s===0?(d=138,l=3):r===s?(d=6,l=3):(d=7,l=4)}},fa=t=>{let n;for(An(t,t.dyn_ltree,t.l_desc.max_code),An(t,t.dyn_dtree,t.d_desc.max_code),ze(t,t.bl_desc),n=ye-1;n>=3&&t.bl_tree[_n[n]*2+1]===0;n--);return t.opt_len+=3*(n+1)+5+5+4,n},ua=(t,n,e,i)=>{let a;for(X(t,n-257,5),X(t,e-1,5),X(t,i-4,4),a=0;a<i;a++)X(t,t.bl_tree[_n[a]*2+1],3);Dn(t,t.dyn_ltree,n-1),Dn(t,t.dyn_dtree,e-1)},ga=t=>{let n=4093624447,e;for(e=0;e<=31;e++,n>>>=1)if(n&1&&t.dyn_ltree[e*2]!==0)return ln;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return cn;for(e=32;e<Ft;e++)if(t.dyn_ltree[e*2]!==0)return cn;return ln};let Ln=!1;const _a=t=>{Ln||(ha(),Ln=!0),t.l_desc=new Te(t.dyn_ltree,pn),t.d_desc=new Te(t.dyn_dtree,mn),t.bl_desc=new Te(t.bl_tree,bn),t.bi_buf=0,t.bi_valid=0,En(t)},Tn=(t,n,e,i)=>{X(t,(na<<1)+(i?1:0),3),yn(t),qt(t,e),qt(t,~e),e&&t.pending_buf.set(t.window.subarray(n,n+e),t.pending),t.pending+=e},pa=t=>{X(t,dn<<1,3),st(t,Se,dt),ca(t)},ma=(t,n,e,i)=>{let a,r,s=0;t.level>0?(t.strm.data_type===ea&&(t.strm.data_type=ga(t)),ze(t,t.l_desc),ze(t,t.d_desc),s=fa(t),a=t.opt_len+3+7>>>3,r=t.static_len+3+7>>>3,r<=a&&(a=r)):a=r=e+5,e+4<=a&&n!==-1?Tn(t,n,e,i):t.strategy===ta||r===a?(X(t,(dn<<1)+(i?1:0),3),Sn(t,dt,Ut)):(X(t,(ia<<1)+(i?1:0),3),ua(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),Sn(t,t.dyn_ltree,t.dyn_dtree)),En(t),i&&yn(t)},ba=(t,n,e)=>(t.pending_buf[t.sym_buf+t.sym_next++]=n,t.pending_buf[t.sym_buf+t.sym_next++]=n>>8,t.pending_buf[t.sym_buf+t.sym_next++]=e,n===0?t.dyn_ltree[e*2]++:(t.matches++,n--,t.dyn_ltree[(Gt[e]+Ft+1)*2]++,t.dyn_dtree[wn(n)*2]++),t.sym_next===t.sym_end);var wa=_a,va=Tn,xa=ma,Ea=ba,ya=pa,ka={_tr_init:wa,_tr_stored_block:va,_tr_flush_block:xa,_tr_tally:Ea,_tr_align:ya},Yt=(t,n,e,i)=>{let a=t&65535|0,r=t>>>16&65535|0,s=0;for(;e!==0;){s=e>2e3?2e3:e,e-=s;do a=a+n[i++]|0,r=r+a|0;while(--s);a%=65521,r%=65521}return a|r<<16|0};const Sa=()=>{let t,n=[];for(var e=0;e<256;e++){t=e;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;n[e]=t}return n},Aa=new Uint32Array(Sa());var U=(t,n,e,i)=>{const a=Aa,r=i+e;t^=-1;for(let s=i;s<r;s++)t=t>>>8^a[(t^n[s])&255];return t^-1},vt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},xt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Da,_tr_stored_block:Re,_tr_flush_block:La,_tr_tally:ut,_tr_align:Ta}=ka,{Z_NO_FLUSH:gt,Z_PARTIAL_FLUSH:Ca,Z_FULL_FLUSH:za,Z_FINISH:et,Z_BLOCK:Cn,Z_OK:q,Z_STREAM_END:zn,Z_STREAM_ERROR:ot,Z_DATA_ERROR:Ra,Z_BUF_ERROR:He,Z_DEFAULT_COMPRESSION:Ha,Z_FILTERED:Ia,Z_HUFFMAN_ONLY:de,Z_RLE:Ma,Z_FIXED:Ba,Z_DEFAULT_STRATEGY:$a,Z_UNKNOWN:Pa,Z_DEFLATED:he}=xt,Oa=9,Fa=15,Na=8,Ua=29,Ie=256+1+Ua,Za=30,Ga=19,qa=2*Ie+1,Ya=15,$=3,_t=258,lt=_t+$+1,ja=32,Rt=42,Me=57,Be=69,$e=73,Pe=91,Oe=103,Et=113,jt=666,j=1,Ht=2,yt=3,It=4,Xa=3,kt=(t,n)=>(t.msg=vt[n],n),Rn=t=>t*2-(t>4?9:0),pt=t=>{let n=t.length;for(;--n>=0;)t[n]=0},Wa=t=>{let n,e,i,a=t.w_size;n=t.hash_size,i=n;do e=t.head[--i],t.head[i]=e>=a?e-a:0;while(--n);n=a,i=n;do e=t.prev[--i],t.prev[i]=e>=a?e-a:0;while(--n)};let mt=(t,n,e)=>(n<<t.hash_shift^e)&t.hash_mask;const K=t=>{const n=t.state;let e=n.pending;e>t.avail_out&&(e=t.avail_out),e!==0&&(t.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+e),t.next_out),t.next_out+=e,n.pending_out+=e,t.total_out+=e,t.avail_out-=e,n.pending-=e,n.pending===0&&(n.pending_out=0))},tt=(t,n)=>{La(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,K(t.strm)},P=(t,n)=>{t.pending_buf[t.pending++]=n},Xt=(t,n)=>{t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=n&255},Fe=(t,n,e,i)=>{let a=t.avail_in;return a>i&&(a=i),a===0?0:(t.avail_in-=a,n.set(t.input.subarray(t.next_in,t.next_in+a),e),t.state.wrap===1?t.adler=Yt(t.adler,n,a,e):t.state.wrap===2&&(t.adler=U(t.adler,n,a,e)),t.next_in+=a,t.total_in+=a,a)},Hn=(t,n)=>{let e=t.max_chain_length,i=t.strstart,a,r,s=t.prev_length,o=t.nice_match;const d=t.strstart>t.w_size-lt?t.strstart-(t.w_size-lt):0,l=t.window,c=t.w_mask,u=t.prev,g=t.strstart+_t;let h=l[i+s-1],p=l[i+s];t.prev_length>=t.good_match&&(e>>=2),o>t.lookahead&&(o=t.lookahead);do if(a=n,!(l[a+s]!==p||l[a+s-1]!==h||l[a]!==l[i]||l[++a]!==l[i+1])){i+=2,a++;do;while(l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&i<g);if(r=_t-(g-i),i=g-_t,r>s){if(t.match_start=n,s=r,r>=o)break;h=l[i+s-1],p=l[i+s]}}while((n=u[n&c])>d&&--e!==0);return s<=t.lookahead?s:t.lookahead},Mt=t=>{const n=t.w_size;let e,i,a;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=n+(n-lt)&&(t.window.set(t.window.subarray(n,n+n-i),0),t.match_start-=n,t.strstart-=n,t.block_start-=n,t.insert>t.strstart&&(t.insert=t.strstart),Wa(t),i+=n),t.strm.avail_in===0)break;if(e=Fe(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=e,t.lookahead+t.insert>=$)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=mt(t,t.ins_h,t.window[a+1]);t.insert&&(t.ins_h=mt(t,t.ins_h,t.window[a+$-1]),t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<$)););}while(t.lookahead<lt&&t.strm.avail_in!==0)},In=(t,n)=>{let e=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,i,a,r,s=0,o=t.strm.avail_in;do{if(i=65535,r=t.bi_valid+42>>3,t.strm.avail_out<r||(r=t.strm.avail_out-r,a=t.strstart-t.block_start,i>a+t.strm.avail_in&&(i=a+t.strm.avail_in),i>r&&(i=r),i<e&&(i===0&&n!==et||n===gt||i!==a+t.strm.avail_in)))break;s=n===et&&i===a+t.strm.avail_in?1:0,Re(t,0,0,s),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,K(t.strm),a&&(a>i&&(a=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+a),t.strm.next_out),t.strm.next_out+=a,t.strm.avail_out-=a,t.strm.total_out+=a,t.block_start+=a,i-=a),i&&(Fe(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(s===0);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),s?It:n!==gt&&n!==et&&t.strm.avail_in===0&&t.strstart===t.block_start?Ht:(r=t.window_size-t.strstart,t.strm.avail_in>r&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,r+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),r>t.strm.avail_in&&(r=t.strm.avail_in),r&&(Fe(t.strm,t.window,t.strstart,r),t.strstart+=r,t.insert+=r>t.w_size-t.insert?t.w_size-t.insert:r),t.high_water<t.strstart&&(t.high_water=t.strstart),r=t.bi_valid+42>>3,r=t.pending_buf_size-r>65535?65535:t.pending_buf_size-r,e=r>t.w_size?t.w_size:r,a=t.strstart-t.block_start,(a>=e||(a||n===et)&&n!==gt&&t.strm.avail_in===0&&a<=r)&&(i=a>r?r:a,s=n===et&&t.strm.avail_in===0&&i===a?1:0,Re(t,t.block_start,i,s),t.block_start+=i,K(t.strm)),s?yt:j)},Ne=(t,n)=>{let e,i;for(;;){if(t.lookahead<lt){if(Mt(t),t.lookahead<lt&&n===gt)return j;if(t.lookahead===0)break}if(e=0,t.lookahead>=$&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+$-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),e!==0&&t.strstart-e<=t.w_size-lt&&(t.match_length=Hn(t,e)),t.match_length>=$)if(i=ut(t,t.strstart-t.match_start,t.match_length-$),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=$){t.match_length--;do t.strstart++,t.ins_h=mt(t,t.ins_h,t.window[t.strstart+$-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=mt(t,t.ins_h,t.window[t.strstart+1]);else i=ut(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(tt(t,!1),t.strm.avail_out===0))return j}return t.insert=t.strstart<$-1?t.strstart:$-1,n===et?(tt(t,!0),t.strm.avail_out===0?yt:It):t.sym_next&&(tt(t,!1),t.strm.avail_out===0)?j:Ht},Bt=(t,n)=>{let e,i,a;for(;;){if(t.lookahead<lt){if(Mt(t),t.lookahead<lt&&n===gt)return j;if(t.lookahead===0)break}if(e=0,t.lookahead>=$&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+$-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=$-1,e!==0&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-lt&&(t.match_length=Hn(t,e),t.match_length<=5&&(t.strategy===Ia||t.match_length===$&&t.strstart-t.match_start>4096)&&(t.match_length=$-1)),t.prev_length>=$&&t.match_length<=t.prev_length){a=t.strstart+t.lookahead-$,i=ut(t,t.strstart-1-t.prev_match,t.prev_length-$),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=a&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+$-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=$-1,t.strstart++,i&&(tt(t,!1),t.strm.avail_out===0))return j}else if(t.match_available){if(i=ut(t,0,t.window[t.strstart-1]),i&&tt(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return j}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=ut(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<$-1?t.strstart:$-1,n===et?(tt(t,!0),t.strm.avail_out===0?yt:It):t.sym_next&&(tt(t,!1),t.strm.avail_out===0)?j:Ht},Va=(t,n)=>{let e,i,a,r;const s=t.window;for(;;){if(t.lookahead<=_t){if(Mt(t),t.lookahead<=_t&&n===gt)return j;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=$&&t.strstart>0&&(a=t.strstart-1,i=s[a],i===s[++a]&&i===s[++a]&&i===s[++a])){r=t.strstart+_t;do;while(i===s[++a]&&i===s[++a]&&i===s[++a]&&i===s[++a]&&i===s[++a]&&i===s[++a]&&i===s[++a]&&i===s[++a]&&a<r);t.match_length=_t-(r-a),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=$?(e=ut(t,1,t.match_length-$),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=ut(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(tt(t,!1),t.strm.avail_out===0))return j}return t.insert=0,n===et?(tt(t,!0),t.strm.avail_out===0?yt:It):t.sym_next&&(tt(t,!1),t.strm.avail_out===0)?j:Ht},Ja=(t,n)=>{let e;for(;;){if(t.lookahead===0&&(Mt(t),t.lookahead===0)){if(n===gt)return j;break}if(t.match_length=0,e=ut(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(tt(t,!1),t.strm.avail_out===0))return j}return t.insert=0,n===et?(tt(t,!0),t.strm.avail_out===0?yt:It):t.sym_next&&(tt(t,!1),t.strm.avail_out===0)?j:Ht};function ct(t,n,e,i,a){this.good_length=t,this.max_lazy=n,this.nice_length=e,this.max_chain=i,this.func=a}const Wt=[new ct(0,0,0,0,In),new ct(4,4,8,4,Ne),new ct(4,5,16,8,Ne),new ct(4,6,32,32,Ne),new ct(4,4,16,16,Bt),new ct(8,16,32,32,Bt),new ct(8,16,128,128,Bt),new ct(8,32,128,256,Bt),new ct(32,128,258,1024,Bt),new ct(32,258,258,4096,Bt)],Qa=t=>{t.window_size=2*t.w_size,pt(t.head),t.max_lazy_match=Wt[t.level].max_lazy,t.good_match=Wt[t.level].good_length,t.nice_match=Wt[t.level].nice_length,t.max_chain_length=Wt[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=$-1,t.match_available=0,t.ins_h=0};function Ka(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=he,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(qa*2),this.dyn_dtree=new Uint16Array((2*Za+1)*2),this.bl_tree=new Uint16Array((2*Ga+1)*2),pt(this.dyn_ltree),pt(this.dyn_dtree),pt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Ya+1),this.heap=new Uint16Array(2*Ie+1),pt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Ie+1),pt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Vt=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||n.status!==Rt&&n.status!==Me&&n.status!==Be&&n.status!==$e&&n.status!==Pe&&n.status!==Oe&&n.status!==Et&&n.status!==jt?1:0},Mn=t=>{if(Vt(t))return kt(t,ot);t.total_in=t.total_out=0,t.data_type=Pa;const n=t.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap===2?Me:n.wrap?Rt:Et,t.adler=n.wrap===2?0:1,n.last_flush=-2,Da(n),q},Bn=t=>{const n=Mn(t);return n===q&&Qa(t.state),n},tr=(t,n)=>Vt(t)||t.state.wrap!==2?ot:(t.state.gzhead=n,q),$n=(t,n,e,i,a,r)=>{if(!t)return ot;let s=1;if(n===Ha&&(n=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),a<1||a>Oa||e!==he||i<8||i>15||n<0||n>9||r<0||r>Ba||i===8&&s!==1)return kt(t,ot);i===8&&(i=9);const o=new Ka;return t.state=o,o.strm=t,o.status=Rt,o.wrap=s,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=a+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+$-1)/$),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<a+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=n,o.strategy=r,o.method=e,Bn(t)},er=(t,n)=>$n(t,n,he,Fa,Na,$a),nr=(t,n)=>{if(Vt(t)||n>Cn||n<0)return t?kt(t,ot):ot;const e=t.state;if(!t.output||t.avail_in!==0&&!t.input||e.status===jt&&n!==et)return kt(t,t.avail_out===0?He:ot);const i=e.last_flush;if(e.last_flush=n,e.pending!==0){if(K(t),t.avail_out===0)return e.last_flush=-1,q}else if(t.avail_in===0&&Rn(n)<=Rn(i)&&n!==et)return kt(t,He);if(e.status===jt&&t.avail_in!==0)return kt(t,He);if(e.status===Rt&&e.wrap===0&&(e.status=Et),e.status===Rt){let a=he+(e.w_bits-8<<4)<<8,r=-1;if(e.strategy>=de||e.level<2?r=0:e.level<6?r=1:e.level===6?r=2:r=3,a|=r<<6,e.strstart!==0&&(a|=ja),a+=31-a%31,Xt(e,a),e.strstart!==0&&(Xt(e,t.adler>>>16),Xt(e,t.adler&65535)),t.adler=1,e.status=Et,K(t),e.pending!==0)return e.last_flush=-1,q}if(e.status===Me){if(t.adler=0,P(e,31),P(e,139),P(e,8),e.gzhead)P(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),P(e,e.gzhead.time&255),P(e,e.gzhead.time>>8&255),P(e,e.gzhead.time>>16&255),P(e,e.gzhead.time>>24&255),P(e,e.level===9?2:e.strategy>=de||e.level<2?4:0),P(e,e.gzhead.os&255),e.gzhead.extra&&e.gzhead.extra.length&&(P(e,e.gzhead.extra.length&255),P(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(t.adler=U(t.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=Be;else if(P(e,0),P(e,0),P(e,0),P(e,0),P(e,0),P(e,e.level===9?2:e.strategy>=de||e.level<2?4:0),P(e,Xa),e.status=Et,K(t),e.pending!==0)return e.last_flush=-1,q}if(e.status===Be){if(e.gzhead.extra){let a=e.pending,r=(e.gzhead.extra.length&65535)-e.gzindex;for(;e.pending+r>e.pending_buf_size;){let o=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+o),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>a&&(t.adler=U(t.adler,e.pending_buf,e.pending-a,a)),e.gzindex+=o,K(t),e.pending!==0)return e.last_flush=-1,q;a=0,r-=o}let s=new Uint8Array(e.gzhead.extra);e.pending_buf.set(s.subarray(e.gzindex,e.gzindex+r),e.pending),e.pending+=r,e.gzhead.hcrc&&e.pending>a&&(t.adler=U(t.adler,e.pending_buf,e.pending-a,a)),e.gzindex=0}e.status=$e}if(e.status===$e){if(e.gzhead.name){let a=e.pending,r;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>a&&(t.adler=U(t.adler,e.pending_buf,e.pending-a,a)),K(t),e.pending!==0)return e.last_flush=-1,q;a=0}e.gzindex<e.gzhead.name.length?r=e.gzhead.name.charCodeAt(e.gzindex++)&255:r=0,P(e,r)}while(r!==0);e.gzhead.hcrc&&e.pending>a&&(t.adler=U(t.adler,e.pending_buf,e.pending-a,a)),e.gzindex=0}e.status=Pe}if(e.status===Pe){if(e.gzhead.comment){let a=e.pending,r;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>a&&(t.adler=U(t.adler,e.pending_buf,e.pending-a,a)),K(t),e.pending!==0)return e.last_flush=-1,q;a=0}e.gzindex<e.gzhead.comment.length?r=e.gzhead.comment.charCodeAt(e.gzindex++)&255:r=0,P(e,r)}while(r!==0);e.gzhead.hcrc&&e.pending>a&&(t.adler=U(t.adler,e.pending_buf,e.pending-a,a))}e.status=Oe}if(e.status===Oe){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(K(t),e.pending!==0))return e.last_flush=-1,q;P(e,t.adler&255),P(e,t.adler>>8&255),t.adler=0}if(e.status=Et,K(t),e.pending!==0)return e.last_flush=-1,q}if(t.avail_in!==0||e.lookahead!==0||n!==gt&&e.status!==jt){let a=e.level===0?In(e,n):e.strategy===de?Ja(e,n):e.strategy===Ma?Va(e,n):Wt[e.level].func(e,n);if((a===yt||a===It)&&(e.status=jt),a===j||a===yt)return t.avail_out===0&&(e.last_flush=-1),q;if(a===Ht&&(n===Ca?Ta(e):n!==Cn&&(Re(e,0,0,!1),n===za&&(pt(e.head),e.lookahead===0&&(e.strstart=0,e.block_start=0,e.insert=0))),K(t),t.avail_out===0))return e.last_flush=-1,q}return n!==et?q:e.wrap<=0?zn:(e.wrap===2?(P(e,t.adler&255),P(e,t.adler>>8&255),P(e,t.adler>>16&255),P(e,t.adler>>24&255),P(e,t.total_in&255),P(e,t.total_in>>8&255),P(e,t.total_in>>16&255),P(e,t.total_in>>24&255)):(Xt(e,t.adler>>>16),Xt(e,t.adler&65535)),K(t),e.wrap>0&&(e.wrap=-e.wrap),e.pending!==0?q:zn)},ir=t=>{if(Vt(t))return ot;const n=t.state.status;return t.state=null,n===Et?kt(t,Ra):q},ar=(t,n)=>{let e=n.length;if(Vt(t))return ot;const i=t.state,a=i.wrap;if(a===2||a===1&&i.status!==Rt||i.lookahead)return ot;if(a===1&&(t.adler=Yt(t.adler,n,e,0)),i.wrap=0,e>=i.w_size){a===0&&(pt(i.head),i.strstart=0,i.block_start=0,i.insert=0);let d=new Uint8Array(i.w_size);d.set(n.subarray(e-i.w_size,e),0),n=d,e=i.w_size}const r=t.avail_in,s=t.next_in,o=t.input;for(t.avail_in=e,t.next_in=0,t.input=n,Mt(i);i.lookahead>=$;){let d=i.strstart,l=i.lookahead-($-1);do i.ins_h=mt(i,i.ins_h,i.window[d+$-1]),i.prev[d&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=d,d++;while(--l);i.strstart=d,i.lookahead=$-1,Mt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=$-1,i.match_available=0,t.next_in=s,t.input=o,t.avail_in=r,i.wrap=a,q};var rr=er,sr=$n,or=Bn,lr=Mn,cr=tr,dr=nr,hr=ir,fr=ar,ur="pako deflate (from Nodeca project)",Jt={deflateInit:rr,deflateInit2:sr,deflateReset:or,deflateResetKeep:lr,deflateSetHeader:cr,deflate:dr,deflateEnd:hr,deflateSetDictionary:fr,deflateInfo:ur};const gr=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);var _r=function(t){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const e=n.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const i in e)gr(e,i)&&(t[i]=e[i])}}return t},pr=t=>{let n=0;for(let i=0,a=t.length;i<a;i++)n+=t[i].length;const e=new Uint8Array(n);for(let i=0,a=0,r=t.length;i<r;i++){let s=t[i];e.set(s,a),a+=s.length}return e},fe={assign:_r,flattenChunks:pr};let Pn=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Pn=!1}const Qt=new Uint8Array(256);for(let t=0;t<256;t++)Qt[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Qt[254]=Qt[254]=1;var mr=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let n,e,i,a,r,s=t.length,o=0;for(a=0;a<s;a++)e=t.charCodeAt(a),(e&64512)===55296&&a+1<s&&(i=t.charCodeAt(a+1),(i&64512)===56320&&(e=65536+(e-55296<<10)+(i-56320),a++)),o+=e<128?1:e<2048?2:e<65536?3:4;for(n=new Uint8Array(o),r=0,a=0;r<o;a++)e=t.charCodeAt(a),(e&64512)===55296&&a+1<s&&(i=t.charCodeAt(a+1),(i&64512)===56320&&(e=65536+(e-55296<<10)+(i-56320),a++)),e<128?n[r++]=e:e<2048?(n[r++]=192|e>>>6,n[r++]=128|e&63):e<65536?(n[r++]=224|e>>>12,n[r++]=128|e>>>6&63,n[r++]=128|e&63):(n[r++]=240|e>>>18,n[r++]=128|e>>>12&63,n[r++]=128|e>>>6&63,n[r++]=128|e&63);return n};const br=(t,n)=>{if(n<65534&&t.subarray&&Pn)return String.fromCharCode.apply(null,t.length===n?t:t.subarray(0,n));let e="";for(let i=0;i<n;i++)e+=String.fromCharCode(t[i]);return e};var wr=(t,n)=>{const e=n||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,n));let i,a;const r=new Array(e*2);for(a=0,i=0;i<e;){let s=t[i++];if(s<128){r[a++]=s;continue}let o=Qt[s];if(o>4){r[a++]=65533,i+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&i<e;)s=s<<6|t[i++]&63,o--;if(o>1){r[a++]=65533;continue}s<65536?r[a++]=s:(s-=65536,r[a++]=55296|s>>10&1023,r[a++]=56320|s&1023)}return br(r,a)},vr=(t,n)=>{n=n||t.length,n>t.length&&(n=t.length);let e=n-1;for(;e>=0&&(t[e]&192)===128;)e--;return e<0||e===0?n:e+Qt[t[e]]>n?e:n},Kt={string2buf:mr,buf2string:wr,utf8border:vr};function xr(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var On=xr;const Fn=Object.prototype.toString,{Z_NO_FLUSH:Er,Z_SYNC_FLUSH:yr,Z_FULL_FLUSH:kr,Z_FINISH:Sr,Z_OK:ue,Z_STREAM_END:Ar,Z_DEFAULT_COMPRESSION:Dr,Z_DEFAULT_STRATEGY:Lr,Z_DEFLATED:Tr}=xt;function te(t){this.options=fe.assign({level:Dr,method:Tr,chunkSize:16384,windowBits:15,memLevel:8,strategy:Lr},t||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new On,this.strm.avail_out=0;let e=Jt.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(e!==ue)throw new Error(vt[e]);if(n.header&&Jt.deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(typeof n.dictionary=="string"?i=Kt.string2buf(n.dictionary):Fn.call(n.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(n.dictionary):i=n.dictionary,e=Jt.deflateSetDictionary(this.strm,i),e!==ue)throw new Error(vt[e]);this._dict_set=!0}}te.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize;let a,r;if(this.ended)return!1;for(n===~~n?r=n:r=n===!0?Sr:Er,typeof t=="string"?e.input=Kt.string2buf(t):Fn.call(t)==="[object ArrayBuffer]"?e.input=new Uint8Array(t):e.input=t,e.next_in=0,e.avail_in=e.input.length;;){if(e.avail_out===0&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(r===yr||r===kr)&&e.avail_out<=6){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(a=Jt.deflate(e,r),a===Ar)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),a=Jt.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===ue;if(e.avail_out===0){this.onData(e.output);continue}if(r>0&&e.next_out>0){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(e.avail_in===0)break}return!0},te.prototype.onData=function(t){this.chunks.push(t)},te.prototype.onEnd=function(t){t===ue&&(this.result=fe.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Ue(t,n){const e=new te(n);if(e.push(t,!0),e.err)throw e.msg||vt[e.err];return e.result}function Cr(t,n){return n=n||{},n.raw=!0,Ue(t,n)}function zr(t,n){return n=n||{},n.gzip=!0,Ue(t,n)}var Rr=te,Hr=Ue,Ir=Cr,Mr=zr,Br=xt,$r={Deflate:Rr,deflate:Hr,deflateRaw:Ir,gzip:Mr,constants:Br};const ge=16209,Pr=16191;var Or=function(n,e){let i,a,r,s,o,d,l,c,u,g,h,p,k,S,L,z,D,_,T,R,v,B,H,x;const b=n.state;i=n.next_in,H=n.input,a=i+(n.avail_in-5),r=n.next_out,x=n.output,s=r-(e-n.avail_out),o=r+(n.avail_out-257),d=b.dmax,l=b.wsize,c=b.whave,u=b.wnext,g=b.window,h=b.hold,p=b.bits,k=b.lencode,S=b.distcode,L=(1<<b.lenbits)-1,z=(1<<b.distbits)-1;t:do{p<15&&(h+=H[i++]<<p,p+=8,h+=H[i++]<<p,p+=8),D=k[h&L];e:for(;;){if(_=D>>>24,h>>>=_,p-=_,_=D>>>16&255,_===0)x[r++]=D&65535;else if(_&16){T=D&65535,_&=15,_&&(p<_&&(h+=H[i++]<<p,p+=8),T+=h&(1<<_)-1,h>>>=_,p-=_),p<15&&(h+=H[i++]<<p,p+=8,h+=H[i++]<<p,p+=8),D=S[h&z];n:for(;;){if(_=D>>>24,h>>>=_,p-=_,_=D>>>16&255,_&16){if(R=D&65535,_&=15,p<_&&(h+=H[i++]<<p,p+=8,p<_&&(h+=H[i++]<<p,p+=8)),R+=h&(1<<_)-1,R>d){n.msg="invalid distance too far back",b.mode=ge;break t}if(h>>>=_,p-=_,_=r-s,R>_){if(_=R-_,_>c&&b.sane){n.msg="invalid distance too far back",b.mode=ge;break t}if(v=0,B=g,u===0){if(v+=l-_,_<T){T-=_;do x[r++]=g[v++];while(--_);v=r-R,B=x}}else if(u<_){if(v+=l+u-_,_-=u,_<T){T-=_;do x[r++]=g[v++];while(--_);if(v=0,u<T){_=u,T-=_;do x[r++]=g[v++];while(--_);v=r-R,B=x}}}else if(v+=u-_,_<T){T-=_;do x[r++]=g[v++];while(--_);v=r-R,B=x}for(;T>2;)x[r++]=B[v++],x[r++]=B[v++],x[r++]=B[v++],T-=3;T&&(x[r++]=B[v++],T>1&&(x[r++]=B[v++]))}else{v=r-R;do x[r++]=x[v++],x[r++]=x[v++],x[r++]=x[v++],T-=3;while(T>2);T&&(x[r++]=x[v++],T>1&&(x[r++]=x[v++]))}}else if(_&64){n.msg="invalid distance code",b.mode=ge;break t}else{D=S[(D&65535)+(h&(1<<_)-1)];continue n}break}}else if(_&64)if(_&32){b.mode=Pr;break t}else{n.msg="invalid literal/length code",b.mode=ge;break t}else{D=k[(D&65535)+(h&(1<<_)-1)];continue e}break}}while(i<a&&r<o);T=p>>3,i-=T,p-=T<<3,h&=(1<<p)-1,n.next_in=i,n.next_out=r,n.avail_in=i<a?5+(a-i):5-(i-a),n.avail_out=r<o?257+(o-r):257-(r-o),b.hold=h,b.bits=p};const $t=15,Nn=852,Un=592,Zn=0,Ze=1,Gn=2,Fr=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Nr=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Ur=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Zr=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ee=(t,n,e,i,a,r,s,o)=>{const d=o.bits;let l=0,c=0,u=0,g=0,h=0,p=0,k=0,S=0,L=0,z=0,D,_,T,R,v,B=null,H;const x=new Uint16Array($t+1),b=new Uint16Array($t+1);let W=null,ae,C,w;for(l=0;l<=$t;l++)x[l]=0;for(c=0;c<i;c++)x[n[e+c]]++;for(h=d,g=$t;g>=1&&x[g]===0;g--);if(h>g&&(h=g),g===0)return a[r++]=1<<24|64<<16|0,a[r++]=1<<24|64<<16|0,o.bits=1,0;for(u=1;u<g&&x[u]===0;u++);for(h<u&&(h=u),S=1,l=1;l<=$t;l++)if(S<<=1,S-=x[l],S<0)return-1;if(S>0&&(t===Zn||g!==1))return-1;for(b[1]=0,l=1;l<$t;l++)b[l+1]=b[l]+x[l];for(c=0;c<i;c++)n[e+c]!==0&&(s[b[n[e+c]]++]=c);if(t===Zn?(B=W=s,H=20):t===Ze?(B=Fr,W=Nr,H=257):(B=Ur,W=Zr,H=0),z=0,c=0,l=u,v=r,p=h,k=0,T=-1,L=1<<h,R=L-1,t===Ze&&L>Nn||t===Gn&&L>Un)return 1;for(;;){ae=l-k,s[c]+1<H?(C=0,w=s[c]):s[c]>=H?(C=W[s[c]-H],w=B[s[c]-H]):(C=32+64,w=0),D=1<<l-k,_=1<<p,u=_;do _-=D,a[v+(z>>k)+_]=ae<<24|C<<16|w|0;while(_!==0);for(D=1<<l-1;z&D;)D>>=1;if(D!==0?(z&=D-1,z+=D):z=0,c++,--x[l]===0){if(l===g)break;l=n[e+s[c]]}if(l>h&&(z&R)!==T){for(k===0&&(k=h),v+=u,p=l-k,S=1<<p;p+k<g&&(S-=x[p+k],!(S<=0));)p++,S<<=1;if(L+=1<<p,t===Ze&&L>Nn||t===Gn&&L>Un)return 1;T=z&R,a[T]=h<<24|p<<16|v-r|0}}return z!==0&&(a[v+z]=l-k<<24|64<<16|0),o.bits=h,0};const Gr=0,qn=1,Yn=2,{Z_FINISH:jn,Z_BLOCK:qr,Z_TREES:_e,Z_OK:St,Z_STREAM_END:Yr,Z_NEED_DICT:jr,Z_STREAM_ERROR:nt,Z_DATA_ERROR:Xn,Z_MEM_ERROR:Wn,Z_BUF_ERROR:Xr,Z_DEFLATED:Vn}=xt,pe=16180,Jn=16181,Qn=16182,Kn=16183,ti=16184,ei=16185,ni=16186,ii=16187,ai=16188,ri=16189,me=16190,ht=16191,Ge=16192,si=16193,qe=16194,oi=16195,li=16196,ci=16197,di=16198,be=16199,we=16200,hi=16201,fi=16202,ui=16203,gi=16204,_i=16205,Ye=16206,pi=16207,mi=16208,F=16209,bi=16210,wi=16211,Wr=852,Vr=592,Jr=15,vi=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Qr(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const At=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||n.mode<pe||n.mode>wi?1:0},xi=t=>{if(At(t))return nt;const n=t.state;return t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=n.wrap&1),n.mode=pe,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(Wr),n.distcode=n.distdyn=new Int32Array(Vr),n.sane=1,n.back=-1,St},Ei=t=>{if(At(t))return nt;const n=t.state;return n.wsize=0,n.whave=0,n.wnext=0,xi(t)},yi=(t,n)=>{let e;if(At(t))return nt;const i=t.state;return n<0?(e=0,n=-n):(e=(n>>4)+5,n<48&&(n&=15)),n&&(n<8||n>15)?nt:(i.window!==null&&i.wbits!==n&&(i.window=null),i.wrap=e,i.wbits=n,Ei(t))},ki=(t,n)=>{if(!t)return nt;const e=new Qr;t.state=e,e.strm=t,e.window=null,e.mode=pe;const i=yi(t,n);return i!==St&&(t.state=null),i},Kr=t=>ki(t,Jr);let Si=!0,je,Xe;const ts=t=>{if(Si){je=new Int32Array(512),Xe=new Int32Array(32);let n=0;for(;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for(ee(qn,t.lens,0,288,je,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;ee(Yn,t.lens,0,32,Xe,0,t.work,{bits:5}),Si=!1}t.lencode=je,t.lenbits=9,t.distcode=Xe,t.distbits=5},Ai=(t,n,e,i)=>{let a;const r=t.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),i>=r.wsize?(r.window.set(n.subarray(e-r.wsize,e),0),r.wnext=0,r.whave=r.wsize):(a=r.wsize-r.wnext,a>i&&(a=i),r.window.set(n.subarray(e-i,e-i+a),r.wnext),i-=a,i?(r.window.set(n.subarray(e-i,e),0),r.wnext=i,r.whave=r.wsize):(r.wnext+=a,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=a))),0},es=(t,n)=>{let e,i,a,r,s,o,d,l,c,u,g,h,p,k,S=0,L,z,D,_,T,R,v,B;const H=new Uint8Array(4);let x,b;const W=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(At(t)||!t.output||!t.input&&t.avail_in!==0)return nt;e=t.state,e.mode===ht&&(e.mode=Ge),s=t.next_out,a=t.output,d=t.avail_out,r=t.next_in,i=t.input,o=t.avail_in,l=e.hold,c=e.bits,u=o,g=d,B=St;t:for(;;)switch(e.mode){case pe:if(e.wrap===0){e.mode=Ge;break}for(;c<16;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}if(e.wrap&2&&l===35615){e.wbits===0&&(e.wbits=15),e.check=0,H[0]=l&255,H[1]=l>>>8&255,e.check=U(e.check,H,2,0),l=0,c=0,e.mode=Jn;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((l&255)<<8)+(l>>8))%31){t.msg="incorrect header check",e.mode=F;break}if((l&15)!==Vn){t.msg="unknown compression method",e.mode=F;break}if(l>>>=4,c-=4,v=(l&15)+8,e.wbits===0&&(e.wbits=v),v>15||v>e.wbits){t.msg="invalid window size",e.mode=F;break}e.dmax=1<<e.wbits,e.flags=0,t.adler=e.check=1,e.mode=l&512?ri:ht,l=0,c=0;break;case Jn:for(;c<16;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}if(e.flags=l,(e.flags&255)!==Vn){t.msg="unknown compression method",e.mode=F;break}if(e.flags&57344){t.msg="unknown header flags set",e.mode=F;break}e.head&&(e.head.text=l>>8&1),e.flags&512&&e.wrap&4&&(H[0]=l&255,H[1]=l>>>8&255,e.check=U(e.check,H,2,0)),l=0,c=0,e.mode=Qn;case Qn:for(;c<32;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}e.head&&(e.head.time=l),e.flags&512&&e.wrap&4&&(H[0]=l&255,H[1]=l>>>8&255,H[2]=l>>>16&255,H[3]=l>>>24&255,e.check=U(e.check,H,4,0)),l=0,c=0,e.mode=Kn;case Kn:for(;c<16;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}e.head&&(e.head.xflags=l&255,e.head.os=l>>8),e.flags&512&&e.wrap&4&&(H[0]=l&255,H[1]=l>>>8&255,e.check=U(e.check,H,2,0)),l=0,c=0,e.mode=ti;case ti:if(e.flags&1024){for(;c<16;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}e.length=l,e.head&&(e.head.extra_len=l),e.flags&512&&e.wrap&4&&(H[0]=l&255,H[1]=l>>>8&255,e.check=U(e.check,H,2,0)),l=0,c=0}else e.head&&(e.head.extra=null);e.mode=ei;case ei:if(e.flags&1024&&(h=e.length,h>o&&(h=o),h&&(e.head&&(v=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(r,r+h),v)),e.flags&512&&e.wrap&4&&(e.check=U(e.check,i,h,r)),o-=h,r+=h,e.length-=h),e.length))break t;e.length=0,e.mode=ni;case ni:if(e.flags&2048){if(o===0)break t;h=0;do v=i[r+h++],e.head&&v&&e.length<65536&&(e.head.name+=String.fromCharCode(v));while(v&&h<o);if(e.flags&512&&e.wrap&4&&(e.check=U(e.check,i,h,r)),o-=h,r+=h,v)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=ii;case ii:if(e.flags&4096){if(o===0)break t;h=0;do v=i[r+h++],e.head&&v&&e.length<65536&&(e.head.comment+=String.fromCharCode(v));while(v&&h<o);if(e.flags&512&&e.wrap&4&&(e.check=U(e.check,i,h,r)),o-=h,r+=h,v)break t}else e.head&&(e.head.comment=null);e.mode=ai;case ai:if(e.flags&512){for(;c<16;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}if(e.wrap&4&&l!==(e.check&65535)){t.msg="header crc mismatch",e.mode=F;break}l=0,c=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=ht;break;case ri:for(;c<32;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}t.adler=e.check=vi(l),l=0,c=0,e.mode=me;case me:if(e.havedict===0)return t.next_out=s,t.avail_out=d,t.next_in=r,t.avail_in=o,e.hold=l,e.bits=c,jr;t.adler=e.check=1,e.mode=ht;case ht:if(n===qr||n===_e)break t;case Ge:if(e.last){l>>>=c&7,c-=c&7,e.mode=Ye;break}for(;c<3;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}switch(e.last=l&1,l>>>=1,c-=1,l&3){case 0:e.mode=si;break;case 1:if(ts(e),e.mode=be,n===_e){l>>>=2,c-=2;break t}break;case 2:e.mode=li;break;case 3:t.msg="invalid block type",e.mode=F}l>>>=2,c-=2;break;case si:for(l>>>=c&7,c-=c&7;c<32;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}if((l&65535)!==(l>>>16^65535)){t.msg="invalid stored block lengths",e.mode=F;break}if(e.length=l&65535,l=0,c=0,e.mode=qe,n===_e)break t;case qe:e.mode=oi;case oi:if(h=e.length,h){if(h>o&&(h=o),h>d&&(h=d),h===0)break t;a.set(i.subarray(r,r+h),s),o-=h,r+=h,d-=h,s+=h,e.length-=h;break}e.mode=ht;break;case li:for(;c<14;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}if(e.nlen=(l&31)+257,l>>>=5,c-=5,e.ndist=(l&31)+1,l>>>=5,c-=5,e.ncode=(l&15)+4,l>>>=4,c-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=F;break}e.have=0,e.mode=ci;case ci:for(;e.have<e.ncode;){for(;c<3;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}e.lens[W[e.have++]]=l&7,l>>>=3,c-=3}for(;e.have<19;)e.lens[W[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,x={bits:e.lenbits},B=ee(Gr,e.lens,0,19,e.lencode,0,e.work,x),e.lenbits=x.bits,B){t.msg="invalid code lengths set",e.mode=F;break}e.have=0,e.mode=di;case di:for(;e.have<e.nlen+e.ndist;){for(;S=e.lencode[l&(1<<e.lenbits)-1],L=S>>>24,z=S>>>16&255,D=S&65535,!(L<=c);){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}if(D<16)l>>>=L,c-=L,e.lens[e.have++]=D;else{if(D===16){for(b=L+2;c<b;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}if(l>>>=L,c-=L,e.have===0){t.msg="invalid bit length repeat",e.mode=F;break}v=e.lens[e.have-1],h=3+(l&3),l>>>=2,c-=2}else if(D===17){for(b=L+3;c<b;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}l>>>=L,c-=L,v=0,h=3+(l&7),l>>>=3,c-=3}else{for(b=L+7;c<b;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}l>>>=L,c-=L,v=0,h=11+(l&127),l>>>=7,c-=7}if(e.have+h>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=F;break}for(;h--;)e.lens[e.have++]=v}}if(e.mode===F)break;if(e.lens[256]===0){t.msg="invalid code -- missing end-of-block",e.mode=F;break}if(e.lenbits=9,x={bits:e.lenbits},B=ee(qn,e.lens,0,e.nlen,e.lencode,0,e.work,x),e.lenbits=x.bits,B){t.msg="invalid literal/lengths set",e.mode=F;break}if(e.distbits=6,e.distcode=e.distdyn,x={bits:e.distbits},B=ee(Yn,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,x),e.distbits=x.bits,B){t.msg="invalid distances set",e.mode=F;break}if(e.mode=be,n===_e)break t;case be:e.mode=we;case we:if(o>=6&&d>=258){t.next_out=s,t.avail_out=d,t.next_in=r,t.avail_in=o,e.hold=l,e.bits=c,Or(t,g),s=t.next_out,a=t.output,d=t.avail_out,r=t.next_in,i=t.input,o=t.avail_in,l=e.hold,c=e.bits,e.mode===ht&&(e.back=-1);break}for(e.back=0;S=e.lencode[l&(1<<e.lenbits)-1],L=S>>>24,z=S>>>16&255,D=S&65535,!(L<=c);){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}if(z&&!(z&240)){for(_=L,T=z,R=D;S=e.lencode[R+((l&(1<<_+T)-1)>>_)],L=S>>>24,z=S>>>16&255,D=S&65535,!(_+L<=c);){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}l>>>=_,c-=_,e.back+=_}if(l>>>=L,c-=L,e.back+=L,e.length=D,z===0){e.mode=_i;break}if(z&32){e.back=-1,e.mode=ht;break}if(z&64){t.msg="invalid literal/length code",e.mode=F;break}e.extra=z&15,e.mode=hi;case hi:if(e.extra){for(b=e.extra;c<b;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}e.length+=l&(1<<e.extra)-1,l>>>=e.extra,c-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=fi;case fi:for(;S=e.distcode[l&(1<<e.distbits)-1],L=S>>>24,z=S>>>16&255,D=S&65535,!(L<=c);){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}if(!(z&240)){for(_=L,T=z,R=D;S=e.distcode[R+((l&(1<<_+T)-1)>>_)],L=S>>>24,z=S>>>16&255,D=S&65535,!(_+L<=c);){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}l>>>=_,c-=_,e.back+=_}if(l>>>=L,c-=L,e.back+=L,z&64){t.msg="invalid distance code",e.mode=F;break}e.offset=D,e.extra=z&15,e.mode=ui;case ui:if(e.extra){for(b=e.extra;c<b;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}e.offset+=l&(1<<e.extra)-1,l>>>=e.extra,c-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=F;break}e.mode=gi;case gi:if(d===0)break t;if(h=g-d,e.offset>h){if(h=e.offset-h,h>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=F;break}h>e.wnext?(h-=e.wnext,p=e.wsize-h):p=e.wnext-h,h>e.length&&(h=e.length),k=e.window}else k=a,p=s-e.offset,h=e.length;h>d&&(h=d),d-=h,e.length-=h;do a[s++]=k[p++];while(--h);e.length===0&&(e.mode=we);break;case _i:if(d===0)break t;a[s++]=e.length,d--,e.mode=we;break;case Ye:if(e.wrap){for(;c<32;){if(o===0)break t;o--,l|=i[r++]<<c,c+=8}if(g-=d,t.total_out+=g,e.total+=g,e.wrap&4&&g&&(t.adler=e.check=e.flags?U(e.check,a,g,s-g):Yt(e.check,a,g,s-g)),g=d,e.wrap&4&&(e.flags?l:vi(l))!==e.check){t.msg="incorrect data check",e.mode=F;break}l=0,c=0}e.mode=pi;case pi:if(e.wrap&&e.flags){for(;c<32;){if(o===0)break t;o--,l+=i[r++]<<c,c+=8}if(e.wrap&4&&l!==(e.total&4294967295)){t.msg="incorrect length check",e.mode=F;break}l=0,c=0}e.mode=mi;case mi:B=Yr;break t;case F:B=Xn;break t;case bi:return Wn;case wi:default:return nt}return t.next_out=s,t.avail_out=d,t.next_in=r,t.avail_in=o,e.hold=l,e.bits=c,(e.wsize||g!==t.avail_out&&e.mode<F&&(e.mode<Ye||n!==jn))&&Ai(t,t.output,t.next_out,g-t.avail_out),u-=t.avail_in,g-=t.avail_out,t.total_in+=u,t.total_out+=g,e.total+=g,e.wrap&4&&g&&(t.adler=e.check=e.flags?U(e.check,a,g,t.next_out-g):Yt(e.check,a,g,t.next_out-g)),t.data_type=e.bits+(e.last?64:0)+(e.mode===ht?128:0)+(e.mode===be||e.mode===qe?256:0),(u===0&&g===0||n===jn)&&B===St&&(B=Xr),B},ns=t=>{if(At(t))return nt;let n=t.state;return n.window&&(n.window=null),t.state=null,St},is=(t,n)=>{if(At(t))return nt;const e=t.state;return e.wrap&2?(e.head=n,n.done=!1,St):nt},as=(t,n)=>{const e=n.length;let i,a,r;return At(t)||(i=t.state,i.wrap!==0&&i.mode!==me)?nt:i.mode===me&&(a=1,a=Yt(a,n,e,0),a!==i.check)?Xn:(r=Ai(t,n,e,e),r?(i.mode=bi,Wn):(i.havedict=1,St))};var rs=Ei,ss=yi,os=xi,ls=Kr,cs=ki,ds=es,hs=ns,fs=is,us=as,gs="pako inflate (from Nodeca project)",ft={inflateReset:rs,inflateReset2:ss,inflateResetKeep:os,inflateInit:ls,inflateInit2:cs,inflate:ds,inflateEnd:hs,inflateGetHeader:fs,inflateSetDictionary:us,inflateInfo:gs};function _s(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var ps=_s;const Di=Object.prototype.toString,{Z_NO_FLUSH:ms,Z_FINISH:bs,Z_OK:ne,Z_STREAM_END:We,Z_NEED_DICT:Ve,Z_STREAM_ERROR:ws,Z_DATA_ERROR:Li,Z_MEM_ERROR:vs}=xt;function ie(t){this.options=fe.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(t&&t.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(n.windowBits&15||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new On,this.strm.avail_out=0;let e=ft.inflateInit2(this.strm,n.windowBits);if(e!==ne)throw new Error(vt[e]);if(this.header=new ps,ft.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=Kt.string2buf(n.dictionary):Di.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(e=ft.inflateSetDictionary(this.strm,n.dictionary),e!==ne)))throw new Error(vt[e])}ie.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize,a=this.options.dictionary;let r,s,o;if(this.ended)return!1;for(n===~~n?s=n:s=n===!0?bs:ms,Di.call(t)==="[object ArrayBuffer]"?e.input=new Uint8Array(t):e.input=t,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),r=ft.inflate(e,s),r===Ve&&a&&(r=ft.inflateSetDictionary(e,a),r===ne?r=ft.inflate(e,s):r===Li&&(r=Ve));e.avail_in>0&&r===We&&e.state.wrap>0&&t[e.next_in]!==0;)ft.inflateReset(e),r=ft.inflate(e,s);switch(r){case ws:case Li:case Ve:case vs:return this.onEnd(r),this.ended=!0,!1}if(o=e.avail_out,e.next_out&&(e.avail_out===0||r===We))if(this.options.to==="string"){let d=Kt.utf8border(e.output,e.next_out),l=e.next_out-d,c=Kt.buf2string(e.output,d);e.next_out=l,e.avail_out=i-l,l&&e.output.set(e.output.subarray(d,d+l),0),this.onData(c)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(r===ne&&o===0)){if(r===We)return r=ft.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(e.avail_in===0)break}}return!0},ie.prototype.onData=function(t){this.chunks.push(t)},ie.prototype.onEnd=function(t){t===ne&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fe.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Je(t,n){const e=new ie(n);if(e.push(t),e.err)throw e.msg||vt[e.err];return e.result}function xs(t,n){return n=n||{},n.raw=!0,Je(t,n)}var Es=ie,ys=Je,ks=xs,Ss=Je,As=xt,Ds={Inflate:Es,inflate:ys,inflateRaw:ks,ungzip:Ss,constants:As};const{Deflate:Ls,deflate:Ts,deflateRaw:Cs,gzip:zs}=$r,{Inflate:Rs,inflate:Hs,inflateRaw:Is,ungzip:Ms}=Ds;var Bs=Ls,$s=Ts,Ps=Cs,Os=zs,Fs=Rs,Ns=Hs,Us=Is,Zs=Ms,Gs=xt,Ti={Deflate:Bs,deflate:$s,deflateRaw:Ps,gzip:Os,Inflate:Fs,inflate:Ns,inflateRaw:Us,ungzip:Zs,constants:Gs};class qs{constructor(n){f(this,"canvas");f(this,"draw");f(this,"imageData");f(this,"background");this.draw=n,this.background={origin:!1,originColor:"",watermark:!1,watermarkColor:"",watermarkText:"",gridline:!1,gridlineColor:""}}initCanvas(n,e){const i=this.draw.createHTMLElement("canvas");return i.classList.add("sf-editor-box-canvas"),this.canvas=i,this.setCanvasInfo(n,e),i}setCanvasInfo(n,e){this.canvas.width=n,this.canvas.height=e}gridLine(n){if(!this.canvas)return;this.background.gridline=!0,this.background.gridlineColor=n;var e=this.canvas.getContext("2d");const{height:i,width:a}=this.canvas;var r=20,s=Math.floor(i/r),o=Math.floor(a/r),d="211, 211, 211";n&&(d=this.colorHandle(n));for(let u=0;u<=s;u++){var l=u*r;e.beginPath(),e.moveTo(0,l),e.lineTo(a,l),e.strokeStyle=`rgba(${d}, ${u%5?"0.4":"1"})`,e.stroke()}for(let u=0;u<=o;u++){var c=u*r;e.beginPath(),e.moveTo(c,0),e.lineTo(c,i),e.strokeStyle=`rgba(${d}, ${u%5?"0.4":"1"})`,e.stroke()}}origin(n){if(!this.canvas)return;this.background.origin=!0,this.background.originColor=n;var e=this.canvas.getContext("2d"),i="211, 211, 211";n&&(i=this.colorHandle(n));const{height:a,width:r}=this.canvas;var s=20;for(let o=0;o<r;o=o+s)for(let d=0;d<a;d=d+s)e.beginPath(),e.strokeStyle=`rgb(${i})`,e.arc(o,d,1,0,2*Math.PI),e.stroke()}waterMark(n,e){if(!this.canvas)return;this.background.watermark=!0,this.background.watermarkColor=e,this.background.watermarkText=n;var i=this.canvas.getContext("2d");const a=n||Mi,{height:r,width:s}=this.canvas;i.font="10px sans-serif";const o=i.measureText(a).width;var d="211, 211, 211";e&&(d=this.colorHandle(e));var l=80*o/20;for(let c=-100;c<s;c=c+l)for(let u=0;u<r;u=u+l)i.font="48px serif",i.fillStyle=`rgba(${d}, 0.3)`,i.translate(c,u),i.rotate(-(Math.PI/180)*45),i.fillText(a,c,u),i.rotate(Math.PI/180*45),i.translate(-c,-u)}colorHandle(n){var e="";return n.includes("#")?e=on.hex.rgb(n.replace("#","")).toString().replace(/\[|\]/g,""):n.includes("hsl")||(n.includes("rgb")?e=n.replace(/rgb|\(|\)/g,""):e=on.keyword.rgb(n).toString().replace(/"\["|"\]"/g,"")),e}drawAuxiliaryLine(n){if(!this.canvas)return;this.unDrawAuxiliaryLine();var e=this.canvas.getContext("2d");const{width:i,height:a}=this.canvas,r=e.getImageData(0,0,i,a);this.imageData=Ti.deflate(new Uint8Array(r.data)),n.forEach(({num:s,type:o})=>{const d=s+10;e.beginPath(),e.setLineDash([10,10]),o==="h"?e.moveTo(0,d):e.moveTo(d,0),o==="h"?e.lineTo(i,d):e.lineTo(d,a),e.strokeStyle="rgb(79, 130, 232)",e.stroke()})}unDrawAuxiliaryLine(){try{if(!this.canvas||!this.imageData)return;var n=this.canvas.getContext("2d");const{width:e,height:i}=this.canvas,a=Ti.inflate(this.imageData),r=new Uint8ClampedArray(a),s=new ImageData(r,e,i);n.putImageData(s,0,0),this.imageData=null}catch{this.imageData=null}}clearCanvas(){var n=this.canvas.getContext("2d");const{height:e,width:i}=this.canvas;n.clearRect(0,0,i,e)}resetCanvas(){this.clearCanvas();const n=this.draw.getEditorBox(),{clientWidth:e,clientHeight:i}=n;this.setCanvasInfo(e,i),this.background.gridline&&this.gridLine(this.background.gridlineColor),this.background.watermark&&this.waterMark(this.background.watermarkText,this.background.watermarkColor),this.background.origin&&this.origin(this.background.originColor)}removeCanvas(){this.canvas.remove()}}const Ci=new Worker("/src/core/Worker/AuxiliaryLine.worker.ts",{type:"module"});class Ys{constructor(n){f(this,"draw");f(this,"move");f(this,"sx");f(this,"sy");f(this,"nodes");this.draw=n}addEvent(n,e){n.addEventListener("click",i=>this.graphClickHandle(i,e)),n.addEventListener("mousedown",this.mouseDownHandle.bind(this)),n.addEventListener("mousemove",i=>this.mouseMoveHandle(i,e)),n.addEventListener("mouseup",this.mouseUpHandle.bind(this)),n.addEventListener("mouseout",this.mouseUpHandle.bind(this)),n.addEventListener("dblclick",i=>this.graphDblclickHandle(i,e)),n.addEventListener("contextmenu",i=>this.contextmenu(i,e))}removeEvent(n){}graphClickHandle(n,e){const{ctrlKey:i}=n,a=e.getID(),r=this.getSelected();if(r&&r.getAttribute("graphid")===a)return;i||this.draw.getGraphDraw().cancelAllFormatPoint(),this.draw.getGraphDraw().getGraphMain(a).classList.add("selected"),this.draw.getEditorEvent().cancelContextmenu(),n.stopPropagation(),n.preventDefault()}graphDblclickHandle(n,e){var h;const i=e.getID(),a='div[class="sf-editor-box-graphs-main-contenteditable"]',s=this.draw.getGraphDraw().getGraphMain(i);this.createContentEditable(e);const o=s.querySelector(a),d=(h=o.parentNode)==null?void 0:h.querySelector("svg"),l=d.querySelector("text"),c=o.children[0];l&&(c.innerHTML=l.innerHTML,l.remove()),c.focus();var u=document.createRange();u.selectNodeContents(c),u.collapse(!1);var g=window.getSelection();g.removeAllRanges(),g.addRange(u),c.addEventListener("blur",()=>{o.remove();const p=c.innerHTML,k=this.draw.createSVGElement("text");k.style.pointerEvents="none",k.style.userSelect="none",k.setAttribute("x","50%"),k.setAttribute("y","50%"),k.setAttribute("text-anchor","middle"),k.innerHTML=p,d.appendChild(k)}),n.stopPropagation(),n.preventDefault()}createContentEditable(n){const e=n.getID(),i=this.draw.getGraphDraw().getGraphMain(e),a=this.draw.createHTMLElement("div");a.classList.add("sf-editor-box-graphs-main-contenteditable");const r=this.draw.createHTMLElement("div");r.setAttribute("contenteditable","true"),a.appendChild(r),i.appendChild(a)}mouseDownHandle(n){if(n.button===2)return;const{offsetX:e,offsetY:i}=n;this.move=!0,this.sx=e,this.sy=i,this.nodes=this.draw.getGraphDraw().getNodeInfo()}mouseMoveHandle(n,e){if(!this.move)return;const{offsetX:i,offsetY:a}=n,r=i-this.sx,s=a-this.sy;e.position.call(e,e.getX()+r,e.getY()+s),this.workerEvent(e)}mouseUpHandle(n){this.move=!1,this.sx=0,this.sy=0,this.draw.getCanvasDraw().unDrawAuxiliaryLine()}workerEvent(n){const e=n.getID(),i=n.getWidth(),a=n.getHeight(),r=n.getX(),s=n.getY(),o={nodeID:e,width:i,height:a,x:r,y:s};Ci.postMessage({current:o,nodes:this.nodes}),Ci.onmessage=({data:d})=>{if(!d.length)return this.draw.getCanvasDraw().unDrawAuxiliaryLine();this.draw.getCanvasDraw().drawAuxiliaryLine(d)}}contextmenu(n,e){this.draw.getEditorEvent().contextmenu(n,e),n.stopPropagation(),n.preventDefault()}getAllGraphMain(){const n="[class='sf-editor-box-graphs-main']";return this.draw.getEditorBox().querySelectorAll(n)}getAllSelected(){const n="[class='sf-editor-box-graphs-main selected']";return this.draw.getEditorBox().querySelectorAll(n)}getSelected(){const n="[class='sf-editor-box-graphs-main selected']";return this.draw.getEditorBox().querySelector(n)}}const js="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Xs=(t=21)=>{let n="",e=crypto.getRandomValues(new Uint8Array(t));for(;t--;)n+=js[e[t]&63];return n};class Qe{constructor(n){f(this,"draw");f(this,"nodeID");f(this,"getID");this.draw=n,this.nodeID=Xs(),this.getID=()=>this.nodeID}getX(){const n=this,e=this.draw.getGraphDraw().getGraphMain(n.getID());return Number(e.style.left.replace("px",""))}getY(){const n=this,e=this.draw.getGraphDraw().getGraphMain(n.getID());return Number(e.style.top.replace("px",""))}getWidth(){const n=this,e=this.draw.getGraphDraw().getGraphBox(n.getID());return Number(e.style.width.replace("px",""))}getHeight(){const n=this,e=this.draw.getGraphDraw().getGraphBox(n.getID());return Number(e.style.height.replace("px",""))}getStroke(){return this.getElement().getAttribute("stroke")}getFill(){return this.getElement().getAttribute("fill")}setX(n){const e=this,i=this.draw.getGraphDraw().getGraphMain(e.getID());i.style.left=n+"px"}setY(n){const e=this,i=this.draw.getGraphDraw().getGraphMain(e.getID());i.style.top=n+"px"}setWidth(n){const e=this,i=this.draw.getGraphDraw().getGraphBox(e.getID());return i.style.width=n+"px",e}setHeight(n){const e=this,i=this.draw.getGraphDraw().getGraphBox(e.getID());return i.style.height=n+"px",e}setStroke(n){const e=this;return e.getElement().setAttribute("stroke",n),e}setFill(n){const e=this;return e.getElement().setAttribute("fill",n),e}position(n,e){const i=this;return i.setX(n),i.setY(e),i}setRotate(n){const e=this,i=this.draw.getGraphDraw().getGraphMain(e.getID());return i.style.transform=`rotate(${n}deg)`,e}addToEditor(n){this.setFill("var(--fill)"),this.setStroke("var(--stroke)"),this.draw.getGraphDraw().addGraph(n)}}class zi extends Qe{constructor(e,i){super(e);f(this,"element");this.getID=()=>i,this.element=e.getEditorBox().querySelector(`[graphid="${i}"][type="graph"]`)}getElement(){return this.element}}const Ws=10,Ke=50,tn=50,en=500,nn=500;class Vs{constructor(n){f(this,"draw");f(this,"move",!1);this.draw=n}addGraph(n){const e=n.getID(),i=n.getElement(),a=this.draw.createHTMLElement("div");a.classList.add("sf-editor-box-graphs-main"),a.style.padding=Ws+"px",a.style.zIndex="20",a.setAttribute("graphid",e),a.setAttribute("type","mainBox");const r=this.draw.createHTMLElement("div");r.classList.add("sf-editor-box-graphs-main-item"),r.setAttribute("type","graphBox");const s=this.draw.createSVGElement("svg");s.setAttribute("width","100%"),s.setAttribute("height","100%"),i.setAttribute("graphid",e),i.setAttribute("type","graph");const o=this.draw.getEditorBox(),d='[class="sf-editor-box-graphs"]',l=o.querySelector(d);s.appendChild(i),r.appendChild(s),a.appendChild(r),l.appendChild(a),this.draw.getGraphEvent().addEvent(r,n),this.createLinkPoint(n),this.createFormatPoint(n),rt(()=>{console.log("## 添加元件");const u=this.draw.getEventBus(),g=this.draw.getListener(),h=this.getNodesNumber(),p=this.draw.getRoot().querySelector('[class="sf-editor-footer"]');if(p){const S=p.querySelector('[command="nums"]');S.innerHTML=h.toString()}u.isSubscribe("graphNumberChanged")&&u.emit("graphNumberChanged",h),g.graphNumberChanged&&g.graphNumberChanged(h)})}createLinkPoint(n){const e=n.getID(),i=this.getGraphMain(e),a=this.draw.createHTMLElement("div");a.classList.add("sf-editor-box-graphs-main-links"),i.appendChild(a),rt(()=>{const s="#fff",o="#067bef",d=[],l=n.getWidth(),c=n.getHeight();d.push({x:0,y:c/2}),d.push({x:l/2,y:0}),d.push({x:l,y:c/2}),d.push({x:l/2,y:c}),d.forEach(({x:u,y:g})=>{const h=this.draw.createHTMLElement("div");h.style.width="10px",h.style.height="10px",h.style.position="absolute",h.style.left=u+10/2+"px",h.style.top=g+10/2+"px",h.style.backgroundColor=s,h.style.borderColor=o,h.style.borderRadius="10px",a.appendChild(h),h.addEventListener("mousedown",()=>{console.log("链接锚点 mousedown")})})})}cancelLinkPoint(n){var a;const e=n.getID();(a=this.getGraphMain(e).querySelector('[class="sf-editor-box-graphs-main-links"]'))==null||a.remove()}createFormatPoint(n){const e=n.getID(),i=this.getGraphMain(e),a=this.draw.createHTMLElement("div");a.classList.add("sf-editor-box-graphs-main-formats"),i.appendChild(a),rt(()=>{const s="#fff",o="#067bef",d=[],l=n.getWidth(),c=n.getHeight();d.push({cursor:"nw-resize",x:0,y:0}),d.push({cursor:"n-resize",x:l/2,y:0}),d.push({cursor:"ne-resize",x:l,y:0}),d.push({cursor:"e-resize",x:l,y:c/2}),d.push({cursor:"se-resize",x:l,y:c}),d.push({cursor:"s-resize",x:l/2,y:c}),d.push({cursor:"sw-resize",x:0,y:c}),d.push({cursor:"w-resize",x:0,y:c/2}),d.forEach(({cursor:g,x:h,y:p})=>{const k=this.draw.createHTMLElement("div");k.style.width="10px",k.style.height="10px",k.style.position="absolute",k.style.left=h+10/2+"px",k.style.top=p+10/2+"px",k.style.backgroundColor=s,k.style.borderColor=o,k.style.cursor=g,a.appendChild(k),k.addEventListener("mousedown",S=>{this.handleFormatMousedown(S,k,n),S.stopPropagation(),S.preventDefault()})});const u=this.draw.createHTMLElement("div");u.classList.add("rotate"),u.addEventListener("mousedown",g=>this.rotateHandle(g,u,n)),a.appendChild(u)})}cancelFormatPoint(n){var a;const e=n.getID();(a=this.getGraphMain(e).querySelector('[class="sf-editor-box-graphs-main-formats"]'))==null||a.remove()}cancelAllFormatPoint(){this.draw.getEditorBox().querySelectorAll("div[class='sf-editor-box-graphs-main selected']").forEach(n=>n.classList.remove("selected"))}handleFormatMousedown(n,e,i){this.move=!0;const a=i.getX(),r=i.getY();var s=i.getWidth(),o=i.getHeight();const{offsetLeft:d,offsetTop:l,offsetWidth:c,offsetHeight:u}=n.target,g=a+d-c/2,h=r+l-u/2;e.style.pointerEvents="none";const p=e.parentNode;p.style.pointerEvents="none";const k=p.parentNode;k.style.pointerEvents="none",this.cancelLinkPoint(i),this.cancelFormatPoint(i);const S=()=>{if(!this.move)return this.draw.getEditorBox().removeEventListener("mousemove",L),n.stopPropagation(),n.preventDefault(),!1;this.move=!1,e.style.pointerEvents="",p.style.pointerEvents="",k.style.pointerEvents="",this.createLinkPoint(i),this.createFormatPoint(i),rt(()=>{console.log("## Graph Resized.");const D={nodeID:i.getID(),width:i.getWidth(),height:i.getHeight(),x:i.getX(),y:i.getY()},_=this.draw.getEventBus(),T=this.draw.getListener();_.isSubscribe("resized")&&_.emit("resized",D),T.resized&&T.resized(D)}),this.draw.getEditorBox().removeEventListener("mousemove",L),this.draw.getEditorBox().removeEventListener("mouseup",S),n.stopPropagation(),n.preventDefault()};this.draw.getEditorBox().addEventListener("mousemove",L),this.draw.getEditorBox().addEventListener("mouseup",S);function L(D){const{offsetX:_,offsetY:T}=D,R=_-g,v=T-h;({"nw-resize":()=>{var H=_,x=T,b=R<0?Math.abs(R)+s:s-R,W=v<0?Math.abs(v)+o:o-v;z({w:b,h:W,x:H,y:x})},"n-resize":()=>{var H=T,x=s,b=v<0?Math.abs(v)+o:o-v;z({y:H,w:x,h:b})},"ne-resize":()=>{var H=T,x=R<0?s+R:R+s,b=o-v;z({y:H,w:x,h:b})},"e-resize":()=>{z({w:R<0?s+R:R+s,h:o})},"se-resize":()=>{z({w:R+s,h:v+o})},"s-resize":()=>{z({w:s,h:o+v})},"sw-resize":()=>{z({x:_,w:s-R,h:o+v})},"w-resize":()=>{z({x:_,w:s-R,h:o})}})[e.style.cursor]()}function z({x:D,y:_,w:T,h:R}){var v=T,B=R;T>=Ke&&T<=en&&D&&i.setX(D),R>=tn&&R<=nn&&_&&i.setY(_),T<Ke&&(v=Ke),T>en&&(v=en),R<tn&&(B=tn),R>nn&&(B=nn),i.setWidth(v),i.setHeight(B)}}rotateHandle(n,e,i){const a=i.getX(),r=i.getY();var s=i.getWidth(),o=i.getHeight();e.style.pointerEvents="none";const d=e.parentNode;d.style.pointerEvents="none";const l=d.parentNode;l.style.pointerEvents="none";const c=()=>(e.style.pointerEvents="",d.style.pointerEvents="",l.style.pointerEvents="",this.draw.getEditorBox().removeEventListener("mousemove",u),this.draw.getEditorBox().removeEventListener("mouseup",c),n.stopPropagation(),n.preventDefault(),!1);this.draw.getEditorBox().addEventListener("mousemove",u),this.draw.getEditorBox().addEventListener("mouseup",c);function u(g){const h=a+s/2,p=r+o/2,k=g.offsetX,S=g.offsetY,L=k-h,z=S-p;let D=Math.atan2(z,L)*180/Math.PI;i.setRotate(D-136+180)}}getNodeInfo(){const n=[];return this.draw.getEditorBox().querySelectorAll('div[class="sf-editor-box-graphs-main"],div[class="sf-editor-box-graphs-main selected"]').forEach(e=>{const i=e.getAttribute("graphid"),a=new zi(this.draw,i),r=a.getWidth(),s=a.getHeight(),o=a.getX(),d=a.getY();n.push({nodeID:i,width:r,height:s,x:o,y:d})}),n}getNodesNumber(){return this.draw.getEditorBox().querySelectorAll('[type="mainBox"]').length}getGraphMain(n){const e=`div[graphid="${n}"][type="mainBox"]`;return this.draw.getEditorBox().querySelector(e)}getGraphBox(n){return this.getGraphMain(n).querySelector('[type="graphBox"]')}}const Js=`
<div class="sf-editor-box-contextmenu-main">
	<!-- svg右键 -->
	<div class="sf-editor-box-contextmenu-main-item graph-item" command="copy">
		<span>
			<i class="iconfont icon-fuzhi"></i>
			复制
		</span>
		<span>Ctrl+C</span>
	</div>
	<div class="sf-editor-box-contextmenu-main-item editor-item" command="paste">
		<span>
			<i class="iconfont icon-niantie"></i>
			粘贴
		</span>
		<span>Ctrl+V</span>
	</div>
	<div class="sf-editor-box-contextmenu-main-item graph-item" command="cut">
		<span>
			<i class="iconfont icon-jianqie"></i>
			剪切
		</span>
		<span>Ctrl+X</span>
	</div>
	<div class="sf-editor-box-contextmenu-main-line editor-item"></div>
	<div class="sf-editor-box-contextmenu-main-item editor-item" command="undo">
		<span>
			<i class="iconfont icon-chexiao"></i>
			撤销
		</span>
		<span>Ctrl+Z</span>
	</div>
	<div class="sf-editor-box-contextmenu-main-item editor-item" command="redo">
		<span>
			<i class="iconfont icon-zhongzuo"></i>
			重做
		</span>
		<span>Ctrl+Y</span>
	</div>

	<!-- 图形右键 -->
	<div class="sf-editor-box-contextmenu-main-line graph-item"></div>
	<div class="sf-editor-box-contextmenu-main-item graph-item" command="top">
		<span>
			<i class="iconfont icon-zhiyudingceng"></i>
			置于顶层
		</span>
		<span>Ctrl+A</span>
	</div>
	<div class="sf-editor-box-contextmenu-main-item graph-item" command="bottom">
		<span>
			<i class="iconfont icon-zhiyudiceng"></i>
			置于底层
		</span>
		<span>Ctrl+A</span>
	</div>
	<div class="sf-editor-box-contextmenu-main-item graph-item" command="holdup">
		<span>
			<i class="iconfont icon-shangyiyiceng"></i>
			上移一层
		</span>
		<span>Ctrl+A</span>
	</div>
	<div class="sf-editor-box-contextmenu-main-item graph-item" command="putdown">
		<span>
			<i class="iconfont icon-xiayiyiceng"></i>
			下移一层
		</span>
		<span>Ctrl+A</span>
	</div>
	<div class="sf-editor-box-contextmenu-main-line graph-item"></div>
	<div class="sf-editor-box-contextmenu-main-item graph-item" command="group">
		<span>
			<i class="iconfont icon-zuhe"></i>
			组合
		</span>
		<span>Ctrl+A</span>
	</div>
	<div class="sf-editor-box-contextmenu-main-item graph-item" command="ungroup">
		<span>
			<i class="iconfont icon-quxiaozuhe"></i>
			取消组合
		</span>
		<span>Ctrl+A</span>
	</div>
</div>
`,Qs=`
<div class="sf-editor-footer-left">
	<!-- 多页 -->
	<i class="iconfont icon-duoye_nor" title="列表" command="list"></i>
	<!-- 当前画布名称 -->
	<span>画布1</span>
	<!-- 分割线 -->
	<div class="line"></div>
	<!-- 加页 -->
	<i class="iconfont icon-jiahao" title="新建画布" command="newpages"></i>
</div>
<div class="sf-editor-footer-right">
	<span>图形: <span  command="nums"></span></span>

	<div class="line"></div>

	<!-- 加减视口大小 -->
	<i class="iconfont icon-jianhao" title="缩小" command="reduce"></i>
	<span class="pageScale" title="重置视口" command="resize">100%</span>
	<i class="iconfont icon-jiahao" title="放大" command="amplify"></i>

	<div class="line"></div>

	<!-- 模板 -->
	<i class="iconfont icon-moban" title="模板" command="template"></i>

	<!-- 全屏 -->
	<i class="iconfont icon-quanping" title="全屏" command="fullscreen"></i>

	<!-- 退出全屏 -->
	<i class="iconfont icon-suoxiao" style="display:none" title="退出全屏" command="exitfullscreen"></i>

	<!-- 帮助 -->
	<i class="iconfont icon-bangzhu" title="帮助" command="help"></i>
</div>
`,Ks=`
<div class="sf-editor-operation-top">
	<div class="left">
		<img src="/public/favor.svg" alt="" />
		<span>文件</span>
		<span>编辑</span>
		<span>选择</span>
		<span>视图</span>
		<span>插入</span>
		<span>画布</span>
		<span>排列</span>
	</div>
	<div class="right">
		<div class="right-shear">分享协作</div>
		<i class="iconfont icon-xiazai"></i>
		<img src="/public/user.png" alt="" />
	</div>
</div>
<div class="sf-editor-operation-bottom">
	<!-- 撤销 -->
	<i class="iconfont icon-chexiao"></i>
	<!-- 重做 -->
	<i class="iconfont icon-zhongzuo"></i>
	<!-- 美化 -->
	<i class="iconfont icon-huabumeihua"></i>
	<div class="line"></div>
	<!-- 背景颜色 -->
	<i class="iconfont icon-ibg"></i>
	<!-- 插入图片 -->
	<i class="iconfont icon-tupian"></i>
	<div class="line"></div>
	<!-- 加粗 -->
	<i class="iconfont icon-jiacu"></i>
	<!-- 斜体 -->
	<i class="iconfont icon-xieti"></i>
	<!-- 下划线 -->
	<i class="iconfont icon-xiahuaxian"></i>
	<!-- 字体颜色 -->
	<i class="iconfont icon-zitiyanse"></i>
	<!-- 填充 -->
	<i class="iconfont icon-beijingyanse"></i>
	<div class="line"></div>
	<!-- 连线宽度 -->
	<i class="iconfont icon-xiantiaokuandu"></i>
	<!-- 连线样式 -->
	<i class="iconfont icon-xiantiaoyangshi"></i>
	<!-- 图层 -->
	<i class="iconfont icon-zhiyudingceng"></i>
</div>
`,to=`
<!-- 基础图形 -->
<h3 class="sf-editor-catalog-title" command="base">
	<div class="icon close"></div>
	基础图形
</h3>
<div class="sf-editor-catalog-item" adapt="base">base</div>
<div class="line"></div>

<!-- Flowchart 流程图 -->
<h3 class="sf-editor-catalog-title" command="Flowchart">
	<div class="icon close"></div>
	Flowchart 流程图
</h3>
<div class="sf-editor-catalog-item" adapt="Flowchart">Flowchart</div>
<div class="line"></div>

<!-- 泳池/泳道 -->
<h3 class="sf-editor-catalog-title" command="pool">
	<div class="icon close"></div>
	泳池/泳道
</h3>
<div class="sf-editor-catalog-item" adapt="pool">pool</div>
<div class="line"></div>

<!-- 统计图 -->
<h3 class="sf-editor-catalog-title" command="chart">
	<div class="icon close"></div>
	统计图
</h3>
<div class="sf-editor-catalog-item" adapt="chart">chart</div>
<div class="line"></div>

<!-- 提示 -->
<div class="more">更多图形</div>
`;var Ri={exports:{}};(function(t,n){(function(e,i){t.exports=i()})(Ni,function(){var e=1e3,i=6e4,a=36e5,r="millisecond",s="second",o="minute",d="hour",l="day",c="week",u="month",g="quarter",h="year",p="date",k="Invalid Date",S=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,L=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,z={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(C){var w=["th","st","nd","rd"],m=C%100;return"["+C+(w[(m-20)%10]||w[m]||w[0])+"]"}},D=function(C,w,m){var A=String(C);return!A||A.length>=w?C:""+Array(w+1-A.length).join(m)+C},_={s:D,z:function(C){var w=-C.utcOffset(),m=Math.abs(w),A=Math.floor(m/60),E=m%60;return(w<=0?"+":"-")+D(A,2,"0")+":"+D(E,2,"0")},m:function C(w,m){if(w.date()<m.date())return-C(m,w);var A=12*(m.year()-w.year())+(m.month()-w.month()),E=w.clone().add(A,u),I=m-E<0,M=w.clone().add(A+(I?-1:1),u);return+(-(A+(m-E)/(I?E-M:M-E))||0)},a:function(C){return C<0?Math.ceil(C)||0:Math.floor(C)},p:function(C){return{M:u,y:h,w:c,d:l,D:p,h:d,m:o,s,ms:r,Q:g}[C]||String(C||"").toLowerCase().replace(/s$/,"")},u:function(C){return C===void 0}},T="en",R={};R[T]=z;var v="$isDayjsObject",B=function(C){return C instanceof W||!(!C||!C[v])},H=function C(w,m,A){var E;if(!w)return T;if(typeof w=="string"){var I=w.toLowerCase();R[I]&&(E=I),m&&(R[I]=m,E=I);var M=w.split("-");if(!E&&M.length>1)return C(M[0])}else{var O=w.name;R[O]=w,E=O}return!A&&E&&(T=E),E||!A&&T},x=function(C,w){if(B(C))return C.clone();var m=typeof w=="object"?w:{};return m.date=C,m.args=arguments,new W(m)},b=_;b.l=H,b.i=B,b.w=function(C,w){return x(C,{locale:w.$L,utc:w.$u,x:w.$x,$offset:w.$offset})};var W=function(){function C(m){this.$L=H(m.locale,null,!0),this.parse(m),this.$x=this.$x||m.x||{},this[v]=!0}var w=C.prototype;return w.parse=function(m){this.$d=function(A){var E=A.date,I=A.utc;if(E===null)return new Date(NaN);if(b.u(E))return new Date;if(E instanceof Date)return new Date(E);if(typeof E=="string"&&!/Z$/i.test(E)){var M=E.match(S);if(M){var O=M[2]-1||0,N=(M[7]||"0").substring(0,3);return I?new Date(Date.UTC(M[1],O,M[3]||1,M[4]||0,M[5]||0,M[6]||0,N)):new Date(M[1],O,M[3]||1,M[4]||0,M[5]||0,M[6]||0,N)}}return new Date(E)}(m),this.init()},w.init=function(){var m=this.$d;this.$y=m.getFullYear(),this.$M=m.getMonth(),this.$D=m.getDate(),this.$W=m.getDay(),this.$H=m.getHours(),this.$m=m.getMinutes(),this.$s=m.getSeconds(),this.$ms=m.getMilliseconds()},w.$utils=function(){return b},w.isValid=function(){return this.$d.toString()!==k},w.isSame=function(m,A){var E=x(m);return this.startOf(A)<=E&&E<=this.endOf(A)},w.isAfter=function(m,A){return x(m)<this.startOf(A)},w.isBefore=function(m,A){return this.endOf(A)<x(m)},w.$g=function(m,A,E){return b.u(m)?this[A]:this.set(E,m)},w.unix=function(){return Math.floor(this.valueOf()/1e3)},w.valueOf=function(){return this.$d.getTime()},w.startOf=function(m,A){var E=this,I=!!b.u(A)||A,M=b.p(m),O=function(Lt,V){var bt=b.w(E.$u?Date.UTC(E.$y,V,Lt):new Date(E.$y,V,Lt),E);return I?bt:bt.endOf(l)},N=function(Lt,V){return b.w(E.toDate()[Lt].apply(E.toDate("s"),(I?[0,0,0,0]:[23,59,59,999]).slice(V)),E)},G=this.$W,Y=this.$M,it=this.$D,Pt="set"+(this.$u?"UTC":"");switch(M){case h:return I?O(1,0):O(31,11);case u:return I?O(1,Y):O(0,Y+1);case c:var Dt=this.$locale().weekStart||0,re=(G<Dt?G+7:G)-Dt;return O(I?it-re:it+(6-re),Y);case l:case p:return N(Pt+"Hours",0);case d:return N(Pt+"Minutes",1);case o:return N(Pt+"Seconds",2);case s:return N(Pt+"Milliseconds",3);default:return this.clone()}},w.endOf=function(m){return this.startOf(m,!1)},w.$set=function(m,A){var E,I=b.p(m),M="set"+(this.$u?"UTC":""),O=(E={},E[l]=M+"Date",E[p]=M+"Date",E[u]=M+"Month",E[h]=M+"FullYear",E[d]=M+"Hours",E[o]=M+"Minutes",E[s]=M+"Seconds",E[r]=M+"Milliseconds",E)[I],N=I===l?this.$D+(A-this.$W):A;if(I===u||I===h){var G=this.clone().set(p,1);G.$d[O](N),G.init(),this.$d=G.set(p,Math.min(this.$D,G.daysInMonth())).$d}else O&&this.$d[O](N);return this.init(),this},w.set=function(m,A){return this.clone().$set(m,A)},w.get=function(m){return this[b.p(m)]()},w.add=function(m,A){var E,I=this;m=Number(m);var M=b.p(A),O=function(Y){var it=x(I);return b.w(it.date(it.date()+Math.round(Y*m)),I)};if(M===u)return this.set(u,this.$M+m);if(M===h)return this.set(h,this.$y+m);if(M===l)return O(1);if(M===c)return O(7);var N=(E={},E[o]=i,E[d]=a,E[s]=e,E)[M]||1,G=this.$d.getTime()+m*N;return b.w(G,this)},w.subtract=function(m,A){return this.add(-1*m,A)},w.format=function(m){var A=this,E=this.$locale();if(!this.isValid())return E.invalidDate||k;var I=m||"YYYY-MM-DDTHH:mm:ssZ",M=b.z(this),O=this.$H,N=this.$m,G=this.$M,Y=E.weekdays,it=E.months,Pt=E.meridiem,Dt=function(V,bt,se,ve){return V&&(V[bt]||V(A,I))||se[bt].slice(0,ve)},re=function(V){return b.s(O%12||12,V,"0")},Lt=Pt||function(V,bt,se){var ve=V<12?"AM":"PM";return se?ve.toLowerCase():ve};return I.replace(L,function(V,bt){return bt||function(se){switch(se){case"YY":return String(A.$y).slice(-2);case"YYYY":return b.s(A.$y,4,"0");case"M":return G+1;case"MM":return b.s(G+1,2,"0");case"MMM":return Dt(E.monthsShort,G,it,3);case"MMMM":return Dt(it,G);case"D":return A.$D;case"DD":return b.s(A.$D,2,"0");case"d":return String(A.$W);case"dd":return Dt(E.weekdaysMin,A.$W,Y,2);case"ddd":return Dt(E.weekdaysShort,A.$W,Y,3);case"dddd":return Y[A.$W];case"H":return String(O);case"HH":return b.s(O,2,"0");case"h":return re(1);case"hh":return re(2);case"a":return Lt(O,N,!0);case"A":return Lt(O,N,!1);case"m":return String(N);case"mm":return b.s(N,2,"0");case"s":return String(A.$s);case"ss":return b.s(A.$s,2,"0");case"SSS":return b.s(A.$ms,3,"0");case"Z":return M}return null}(V)||M.replace(":","")})},w.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},w.diff=function(m,A,E){var I,M=this,O=b.p(A),N=x(m),G=(N.utcOffset()-this.utcOffset())*i,Y=this-N,it=function(){return b.m(M,N)};switch(O){case h:I=it()/12;break;case u:I=it();break;case g:I=it()/3;break;case c:I=(Y-G)/6048e5;break;case l:I=(Y-G)/864e5;break;case d:I=Y/a;break;case o:I=Y/i;break;case s:I=Y/e;break;default:I=Y}return E?I:b.a(I)},w.daysInMonth=function(){return this.endOf(u).$D},w.$locale=function(){return R[this.$L]},w.locale=function(m,A){if(!m)return this.$L;var E=this.clone(),I=H(m,A,!0);return I&&(E.$L=I),E},w.clone=function(){return b.w(this.$d,this)},w.toDate=function(){return new Date(this.valueOf())},w.toJSON=function(){return this.isValid()?this.toISOString():null},w.toISOString=function(){return this.$d.toISOString()},w.toString=function(){return this.$d.toUTCString()},C}(),ae=W.prototype;return x.prototype=ae,[["$ms",r],["$s",s],["$m",o],["$H",d],["$W",l],["$M",u],["$y",h],["$D",p]].forEach(function(C){ae[C[1]]=function(w){return this.$g(w,C[0],C[1])}}),x.extend=function(C,w){return C.$i||(C(w,W,x),C.$i=!0),x},x.locale=H,x.isDayjs=B,x.unix=function(C){return x(1e3*C)},x.en=R[T],x.Ls=R,x.p={},x})})(Ri);var eo=Ri.exports;const Hi=Ui(eo);var Z=(t=>(t.Space=" ",t.Delete="Delete",t.Backspace="Backspace",t.Enter="Enter",t.Left="ArrowLeft",t.Right="ArrowRight",t.Up="ArrowUp",t.Down="ArrowDown",t.ESC="Escape",t.TAB="Tab",t.META="Meta",t.LEFT_BRACKET="[",t.RIGHT_BRACKET="]",t.COMMA=",",t.PERIOD=".",t.LEFT_ANGLE_BRACKET="<",t.RIGHT_ANGLE_BRACKET=">",t.EQUAL="=",t.MINUS="-",t.PLUS="+",t.A="a",t.B="b",t.C="c",t.D="d",t.E="e",t.F="f",t.G="g",t.H="h",t.I="i",t.J="j",t.K="k",t.L="l",t.M="m",t.N="n",t.O="o",t.P="p",t.Q="q",t.R="r",t.S="s",t.T="t",t.U="u",t.V="v",t.W="w",t.X="x",t.Y="y",t.Z="z",t.A_UPPERCASE="A",t.B_UPPERCASE="B",t.C_UPPERCASE="C",t.D_UPPERCASE="D",t.E_UPPERCASE="E",t.F_UPPERCASE="F",t.G_UPPERCASE="G",t.H_UPPERCASE="H",t.I_UPPERCASE="I",t.J_UPPERCASE="J",t.K_UPPERCASE="K",t.L_UPPERCASE="L",t.M_UPPERCASE="M",t.N_UPPERCASE="N",t.O_UPPERCASE="O",t.P_UPPERCASE="P",t.Q_UPPERCASE="Q",t.R_UPPERCASE="R",t.S_UPPERCASE="S",t.T_UPPERCASE="T",t.U_UPPERCASE="U",t.V_UPPERCASE="V",t.W_UPPERCASE="W",t.X_UPPERCASE="X",t.Y_UPPERCASE="Y",t.Z_UPPERCASE="Z",t.ZERO="0",t.ONE="1",t.TWO="2",t.THREE="3",t.FOUR="4",t.FIVE="5",t.SIX="6",t.SEVEN="7",t.EIGHT="8",t.NINE="9",t))(Z||{});class no{constructor(n){f(this,"draw");f(this,"defaultEvent");this.draw=n,this.defaultEvent=[{key:Z.Left,callback:this.graphMoveHandle.bind(this)},{key:Z.Up,callback:this.graphMoveHandle.bind(this)},{key:Z.Right,callback:this.graphMoveHandle.bind(this)},{key:Z.Down,callback:this.graphMoveHandle.bind(this)},{key:Z.Left,ctrl:!0,callback:this.graphMoveHandle.bind(this)},{key:Z.Up,ctrl:!0,callback:this.graphMoveHandle.bind(this)},{key:Z.Right,ctrl:!0,callback:this.graphMoveHandle.bind(this)},{key:Z.Down,ctrl:!0,callback:this.graphMoveHandle.bind(this)},{key:Z.Backspace,callback:this.deleteGraph.bind(this)},{key:Z.Delete,callback:this.deleteGraph.bind(this)},{key:Z.C,ctrl:!0,callback:this.copy.bind(this)},{key:Z.V,ctrl:!0,callback:this.paste.bind(this)},{key:Z.X,ctrl:!0,callback:this.cut.bind(this)},{key:Z.P,ctrl:!0,callback:this.print.bind(this)},{key:Z.Z,ctrl:!0},{key:Z.Y,ctrl:!0}]}graphMoveHandle(n){const e=this.draw.getGraphEvent().getAllSelected();if(!e.length)return;const i=10,a=2,r=n!=null&&n.ctrl?a:i;e.forEach(s=>{const o=s.getAttribute("graphid"),d=new zi(this.draw,o),l=d.getX(),c=d.getY();(n==null?void 0:n.key)=="ArrowLeft"&&d.setX(l-r),(n==null?void 0:n.key)=="ArrowUp"&&d.setY(c-r),(n==null?void 0:n.key)=="ArrowRight"&&d.setX(l+r),(n==null?void 0:n.key)=="ArrowDown"&&d.setY(c+r)})}deleteGraph(){const n=this.draw.getGraphEvent().getAllSelected();n.length&&(n.forEach(e=>e.remove()),rt(()=>{const e=this.draw.getEventBus(),i=this.draw.getListener(),a=this.draw.getGraphDraw().getNodesNumber(),r=this.draw.getRoot().querySelector('[class="sf-editor-footer"]');if(r){const o=r.querySelector('[command="nums"]');o.innerHTML=a.toString()}e.isSubscribe("graphNumberChanged")&&e.emit("graphNumberChanged",a),i.graphNumberChanged&&i.graphNumberChanged(a)}))}copy(){console.log("copy")}paste(){console.log("paste")}cut(){console.log("cut")}print(){}keydownHandle(n){rt(()=>{const e=this.draw.getRegister().shortcutList,a=[...this.defaultEvent,...e].filter(r=>(r.mod?Oi(n)===!!r.mod:n.ctrlKey===!!r.ctrl&&n.metaKey===!!r.meta)&&n.shiftKey===!!r.shift&&n.altKey===!!r.alt&&n.key===r.key);a.length&&a.forEach(r=>{var s;return(s=r==null?void 0:r.callback)==null?void 0:s.call(r,{tips:"参数仅供默认事件处理函数使用,无实际含义!",e:n,ctrl:n.ctrlKey,shift:n.shiftKey,key:n.key})})}),n.stopPropagation(),n.preventDefault()}}class io{constructor(n){f(this,"draw");f(this,"editorBox");f(this,"st");f(this,"mode");f(this,"move");f(this,"sx");f(this,"sy");f(this,"ex");f(this,"ey");f(this,"registerEvent");f(this,"command");f(this,"_contextmenu");f(this,"_mousedownHandle");f(this,"_mousemoveHandle");f(this,"_mouseupHandle");f(this,"_keydownHandle");f(this,"_scaleHandle");this.draw=n,this.registerEvent=new no(n),this.command=new at(n);const e=this.registerEvent;this._contextmenu=this.contextmenu.bind(this),this._mousedownHandle=this.mousedownHandle.bind(this),this._mousemoveHandle=this.mousemoveHandle.bind(this),this._mouseupHandle=this.mouseupHandle.bind(this),this._keydownHandle=e.keydownHandle.bind(e),this._scaleHandle=this.setScale.bind(this)}addEvent(){this.editorBox=this.draw.getEditorBox(),this.editorBox.addEventListener("contextmenu",this._contextmenu),this.editorBox.addEventListener("mousedown",this._mousedownHandle),this.editorBox.addEventListener("mousemove",this._mousemoveHandle),this.editorBox.addEventListener("mouseup",this._mouseupHandle),document.addEventListener("keydown",this._keydownHandle),document.addEventListener("wheel",this._scaleHandle,{passive:!1})}removeEvent(){const n=this.draw.getEditorBox();n.removeEventListener("contextmenu",this._contextmenu),n.removeEventListener("mousedown",this._mousedownHandle),n.removeEventListener("mousemove",this._mousemoveHandle),n.removeEventListener("mouseup",this._mouseupHandle),document.removeEventListener("keydown",this._keydownHandle),document.removeEventListener("wheel",this._scaleHandle)}mousedownHandle(n){if(!!this.draw.getRoot().getAttribute("move")||n.target.className!=="sf-editor-box-graphs"||n.button===2)return this.st=0;this.st=Number(Hi().format("mmssSSS")),this.move=!0,this.cancelContextmenu(),this.draw.getGraphDraw().cancelAllFormatPoint();const{offsetX:i,offsetY:a}=n;this.sx=i,this.sy=a;const r='div[class="sf-editor-box-selectmask"]',s=this.editorBox.querySelector(r);s.style.left=i+"px",s.style.top=a+"px",s.style.display="block",this.editorBox.querySelectorAll("div[class='sf-editor-box-graphs-main']").forEach(o=>o.style.pointerEvents="none")}mousemoveHandle(n){if(!this.move)return;const{offsetX:e,offsetY:i}=n,a='div[class="sf-editor-box-selectmask"]',r=this.editorBox.querySelector(a);e-this.sx<0&&(r.style.left=`${e}px`),i-this.sy<0&&(r.style.top=`${i}px`),r.style.height=`${Math.abs(i-this.sy)}px`,r.style.width=`${Math.abs(e-this.sx)}px`}async mouseupHandle(n){if(!this.move)return;this.move=!1;const e='div[class="sf-editor-box-selectmask"]',i=this.editorBox.querySelector(e);if(i.style.left="0",i.style.top="0",i.style.width="0",i.style.height="0",i.style.display="none",this.editorBox.querySelectorAll("div[class='sf-editor-box-graphs-main']").forEach(o=>o.style.pointerEvents=""),Number(Hi().format("mmssSSS"))-this.st<=120)return this.clickHandle(n);const{offsetX:r,offsetY:s}=n;this.ex=r,this.ey=s,await this.computedSelected(),this.st=0,this.sx=0,this.sy=0,this.ex=0,this.ey=0}computedSelected(){return new Promise(n=>{let e=[Math.min(this.sx,this.ex),Math.max(this.sx,this.ex)],i=[Math.min(this.sy,this.ey),Math.max(this.sy,this.ey)],a=[];const r=this.draw.getGraphDraw().getNodeInfo();if(!r)return[];r.forEach(({nodeID:s,width:o,height:d,x:l,y:c})=>{const u={x:l,y:c},g={x:l+o,y:c},h={x:l,y:c+d},p={x:l+o,y:c+d},k=this.computedIsSelected(u,e,i),S=this.computedIsSelected(g,e,i),L=this.computedIsSelected(h,e,i),z=this.computedIsSelected(p,e,i);function D(){(k||S||z||L)&&a.push(s)}function _(){k&&S&&z&&L&&a.push(s)}this.mode==="inside"?D():_()}),a.length||n(),a.forEach(s=>this.draw.getGraphDraw().getGraphMain(s).classList.add("selected")),n()})}computedIsSelected(n,e,i){let a=n.x>=e[0]&&n.x<=e[1],r=n.y>=i[0]&&n.y<=i[1];return a&&r}setScale(n){if(!n.ctrlKey)return;const e=n.deltaY<0?"Add":"Minus";this.scalePage(e),n.preventDefault()}scalePage(n,e){var i=0;const a=.2,r=this.draw.getEditorBox(),s=r.style.transform.split(" "),o=Number(s[0].replace(/\(|\)|scale/g,""));n==="Add"&&(i=o+a),n==="Minus"&&(i=o-a),n==="Recovery"&&(i=1),n==="Appoint"&&(i=e),i<.4&&(i=.4),i>2&&(i=2),r.style.transform=`scale(${i}) ${s[1]}${s[2]}`;const d=this.draw.getRoot().querySelector('[class="sf-editor-footer"]');if(d){const l=d.querySelector('[command="resize"]');l.innerHTML=Math.floor(i*100).toString()+"%"}rt(()=>{const l=this.draw.getEventBus(),c=this.draw.getListener();l.isSubscribe("pageScale")&&l.emit("pageScale",e),c.pageScale&&c.pageScale(e)})}clickHandle(n){this.cancelContextmenu(),this.draw.getGraphDraw().cancelAllFormatPoint(),n.stopPropagation(),n.preventDefault()}contextmenu(n,e){const i='div[class="sf-editor-box-contextmenu"]',a=this.editorBox.querySelector(i);e&&(this.draw.getGraphDraw().cancelAllFormatPoint(),this.draw.getGraphDraw().getGraphMain(e.getID()).classList.add("selected")),a?this.updateContentmenu(n,e):this.createContextmenu(n,e),n.stopPropagation(),n.preventDefault()}updateContentmenu(n,e){const i='div[class="sf-editor-box-contextmenu"]',a=this.editorBox.querySelector(i),r=a.querySelector("div");r.classList.remove("graph"),r.classList.remove("editor"),r.classList.add(e?"graph":"editor"),this.correctContextMenuPosition(a,n)}createContextmenu(n,e){var r;const i=this.draw.createHTMLElement("div");i.classList.add("sf-editor-box-contextmenu"),i.innerHTML=Js,this.editorBox.append(i);const a=i.querySelector("div");a.classList.remove("graph"),a.classList.remove("editor"),a.classList.add(e?"graph":"editor"),this.correctContextMenuPosition(i,n),(r=this.editorBox.querySelector('div[class="sf-editor-box-contextmenu"]'))==null||r.querySelectorAll("[command]").forEach(s=>s.addEventListener("click",o=>this.contextmenuClickHandle(o,s.getAttribute("command")))),rt(()=>{const{contextMenuList:s}=this.draw.getRegister();if(!s.length)return;const o=this.draw.createHTMLElement("div");o.classList.add("sf-editor-box-contextmenu-main-line"),i.children[0].appendChild(o),s.forEach(({title:d,callback:l,command:c,isGraph:u,shortCut:g})=>{const h=this.draw.createHTMLElement("div");h.classList.add("sf-editor-box-contextmenu-main-item"),h.classList.add(u?"graph-item":"editor-item"),h.setAttribute("command",c);const p=this.draw.createHTMLElement("span");p.innerHTML=d,p.style.paddingLeft="20px";const k=this.draw.createHTMLElement("span");k.innerHTML=g||"",h.appendChild(p),h.appendChild(k),i.children[0].appendChild(h),h.addEventListener("click",S=>{l&&l(S),this.clickHandle(S)})})}),i.addEventListener("contextmenu",s=>(s.preventDefault(),s.stopPropagation()))}contextmenuClickHandle(n,e){const i={paste:this.command.executePaste,top:this.command.executeTop,bottom:this.command.executeBottom,holdup:this.command.executeHoldUp,putdown:this.command.executePutDown};e&&i[e]&&i[e](),console.log(e),this.clickHandle(n)}correctContextMenuPosition(n,e){const{clientHeight:i,clientWidth:a}=this.editorBox,r=n.clientWidth,s=n.clientHeight,{offsetX:o,offsetY:d}=e;var l=o,c=d;e.target;const u=e.target.getAttribute("graphid"),g=this.draw.getGraphDraw().getGraphMain(u);if(g){var h=g.style.left.replace("px",""),p=g.style.top.replace("px","");l=Number(h+o),c=Number(p+d)}l+r>a&&(l-=r),c+s>i&&(c-=s),n.style.left=l+"px",n.style.top=c+"px"}cancelContextmenu(){const n='div[class="sf-editor-box-contextmenu"]',e=this.editorBox.querySelector(n);e&&e.remove()}}class ao{constructor(n){f(this,"draw");f(this,"command");this.draw=n,this.command=new at(n),this.initEvent()}initEvent(){rt(()=>{const n=this.draw.getRoot().querySelector('[class="sf-editor-footer"]'),e={reduce:this.command.executePageScaleMinus,resize:this.command.executePageScaleRecovery,amplify:this.command.executePageScaleAdd,fullscreen:()=>this.changeFullScreenIcon(!0),exitfullscreen:()=>this.changeFullScreenIcon(!1)};n.querySelectorAll("[command]").forEach(i=>{const a=i.getAttribute("command");i.addEventListener("click",r=>{e[a]&&e[a](),r.stopPropagation(),r.preventDefault()})})})}changeFullScreenIcon(n){const e=this.draw.getRoot().querySelector('[class="sf-editor-footer"]'),i=e.querySelector('[command="fullscreen"]'),a=e.querySelector('[command="exitfullscreen"]');n?this.command.executeFullScreen():this.command.executeExitFullScreen(),i.style.display=n?"none":"block",a.style.display=n?"block":"none"}}class ro{constructor(n){f(this,"draw");f(this,"command");this.draw=n,this.command=new at(n),this.initEvent()}initEvent(){console.log(this.draw,this.command)}}class so{constructor(n){f(this,"draw");f(this,"command");this.draw=n,this.command=new at(n),this.initEvent()}initEvent(){console.log(this.draw,this.command)}}class oo{constructor(n,e,i,a){f(this,"listener");f(this,"eventBus");f(this,"register");f(this,"canvasDraw");f(this,"graphDraw");f(this,"graphEvent");f(this,"editorEvent");f(this,"footerEvent");f(this,"operationEvent");f(this,"catalogEvent");f(this,"root");f(this,"editorBox");f(this,"getRoot",()=>this.root);f(this,"getListener",()=>this.listener);f(this,"getEventBus",()=>this.eventBus);f(this,"getRegister",()=>this.register);f(this,"getGraphDraw",()=>this.graphDraw);f(this,"getEditorBox",()=>this.editorBox);f(this,"getGraphEvent",()=>this.graphEvent);f(this,"getEditorEvent",()=>this.editorEvent);f(this,"getCanvasDraw",()=>this.canvasDraw);f(this,"getFooterEvent",()=>this.footerEvent);f(this,"getOperationEvent",()=>this.operationEvent);f(this,"getCatalogEvent",()=>this.catalogEvent);this.listener=e,this.eventBus=i,this.register=a,this.canvasDraw=new qs(this),this.graphDraw=new Vs(this),this.graphEvent=new Ys(this),this.editorEvent=new io(this),Fi("colorful_theme1"),this.initEditor(n),this.editorEvent.addEvent(),this.initSelectMask(),rt(()=>{console.log("## SFEditor 编辑器初始化完成。"),this.eventBus.isSubscribe("loaded")&&this.eventBus.emit("loaded"),this.listener.loaded&&this.listener.loaded()})}initEditor(n){if(!n)throw new Error(an.selectorEmpty);const e=document.querySelector(n);if(!e)throw new Error(an.selectorError);this.root=this.createHTMLElement("div"),this.root.classList.add("sf-editor"),this.editorBox=this.createHTMLElement("div"),this.editorBox.classList.add("sf-editor-box"),this.editorBox.style.transform="scale(1) translate(0, 0)";const i=this.createHTMLElement("div");i.classList.add("sf-editor-box-graphs"),this.editorBox.appendChild(i),this.root.appendChild(this.editorBox),e.appendChild(this.root);const{clientWidth:a,clientHeight:r}=this.editorBox,s=this.canvasDraw.initCanvas(a,r);this.editorBox.appendChild(s),this.canvasDraw.origin(),this.canvasDraw.waterMark()}initSelectMask(){const n=this.createHTMLElement("div");n.classList.add("sf-editor-box-selectmask"),this.editorBox.appendChild(n)}initFooter(){const n=this.createHTMLElement("div");n.classList.add("sf-editor-footer"),this.root.appendChild(n),n.innerHTML=Qs,this.footerEvent=new ao(this),this.resize()}initOperation(){const n=this.createHTMLElement("div");n.classList.add("sf-editor-operation"),this.root.appendChild(n),n.innerHTML=Ks,this.operationEvent=new ro(this),this.resize()}initCatalog(){const n=this.createHTMLElement("div");n.classList.add("sf-editor-catalog"),this.root.appendChild(n),n.innerHTML=to,this.catalogEvent=new so(this),this.resize()}resize(){const n=this.root.querySelector('[class="sf-editor-footer"]'),e=this.root.querySelector('[class="sf-editor-operation"]'),i=this.root.querySelector('[class="sf-editor-catalog"]');this.editorBox.style.height=`calc(100% - 
      ${n?n.clientHeight+"px":""} -
      ${e?e.clientHeight+"px":""}
      )`,e&&(this.editorBox.style.top=e.clientHeight+"px",i&&(i.style.top=e.clientHeight+"px",i.style.height=this.editorBox.style.height,this.editorBox.style.left=i.clientWidth+"px")),this.canvasDraw.resetCanvas()}createHTMLElement(n){return document.createElement(n)}createSVGElement(n){return document.createElementNS(Bi,n)}destroy(){this.editorBox.remove(),this.canvasDraw.removeCanvas(),this.editorEvent.removeEvent(),rt(()=>{this.eventBus.isSubscribe("destroyed")&&this.eventBus.emit("destroyed"),this.listener.destroyed&&this.listener.destroyed()})}}class lo{constructor(n){f(this,"draw");this.draw=n}destroy(){this.draw.destroy()}reset(){console.log("global api reset.")}}class co{constructor(){f(this,"eventHub");this.eventHub=new Map}on(n,e){if(!n||typeof e!="function")return;const i=this.eventHub.get(n)||new Set;i.add(e),this.eventHub.set(n,i)}emit(n,e){if(!n)return;const i=this.eventHub.get(n);if(i){if(i.size===1)return[...i][0](e);i.forEach(a=>a(e))}}off(n,e){if(!n||typeof e!="function")return;const i=this.eventHub.get(n);i&&i.delete(e)}isSubscribe(n){const e=this.eventHub.get(n);return!!e&&e.size>0}}class ho{constructor(){f(this,"destroyed");f(this,"resized");f(this,"loaded");f(this,"moved");f(this,"graphNumberChanged");f(this,"pageScale");this.loaded=null,this.destroyed=null,this.resized=null,this.moved=null,this.graphNumberChanged=null,this.pageScale=null}}class fo{constructor(){f(this,"contextMenuList");f(this,"shortcutList");this.contextMenuList=[],this.shortcutList=[]}}class uo extends Qe{constructor(e,i,a){super(e);f(this,"rect");this.rect=e.createSVGElement("rect"),this.rect.setAttribute("width","100%"),this.rect.setAttribute("height","100%"),super.addToEditor(this),super.setWidth.call(this,i),super.setHeight.call(this,a)}getElement(){return this.rect}}class Ii extends Qe{constructor(e,i,a){super(e);f(this,"ellipse");this.ellipse=e.createSVGElement("ellipse"),this.ellipse.setAttribute("rx","50%"),this.ellipse.setAttribute("ry","50%"),this.ellipse.setAttribute("cx","50%"),this.ellipse.setAttribute("cy","50%"),super.addToEditor(this),super.setWidth.call(this,i*2),super.setHeight.call(this,a*2)}getElement(){return this.ellipse}}const Lo="",To="";class go{constructor(n){f(this,"listener");f(this,"eventBus");f(this,"register");f(this,"command");f(this,"global");f(this,"draw");this.listener=new ho,this.eventBus=new co,this.register=new fo,this.draw=new oo(n,this.listener,this.eventBus,this.register),this.global=new lo(this.draw),this.command=new at(this.draw)}Rect(n,e){return new uo(this.draw,n,e)}Circle(n){return new Ii(this.draw,n,n)}Ellipse(n,e){return new Ii(this.draw,n,e)}plugin(n){n==="footer"&&this.draw.initFooter(),n==="operation"&&this.draw.initOperation(),n==="catalog"&&this.draw.initCatalog()}}J.KeyMap=Z,J.SFEditor=go,Object.defineProperty(J,Symbol.toStringTag,{value:"Module"})});
